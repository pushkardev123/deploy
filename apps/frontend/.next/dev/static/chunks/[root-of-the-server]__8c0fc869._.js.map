{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":["turbopack:///[next]/internal/font/google/inter_d46a1eef.module.css [app-client] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"className\": \"inter_d46a1eef-module__87sQYq__className\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA","ignoreList":[0]}},
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["turbopack:///[next]/internal/font/google/inter_d46a1eef.js"],"sourcesContent":["import cssModule from \"@vercel/turbopack-next/internal/font/google/cssmodule.module.css?{%22path%22:%22page.js%22,%22import%22:%22Inter%22,%22arguments%22:[{%22subsets%22:[%22latin%22],%22weight%22:[%22400%22,%22500%22,%22600%22,%22700%22]}],%22variableName%22:%22inter%22}\";\nconst fontData = {\n    className: cssModule.className,\n    style: {\n        fontFamily: \"'Inter', 'Inter Fallback'\",\n        fontStyle: \"normal\",\n\n    },\n};\n\nif (cssModule.variable != null) {\n    fontData.variable = cssModule.variable;\n}\n\nexport default fontData;\n"],"names":[],"mappings":";;;;AAAA;;AACA,MAAM,WAAW;IACb,WAAW,mKAAS,CAAC,SAAS;IAC9B,OAAO;QACH,YAAY;QACZ,WAAW;IAEf;AACJ;AAEA,IAAI,mKAAS,CAAC,QAAQ,IAAI,MAAM;IAC5B,SAAS,QAAQ,GAAG,mKAAS,CAAC,QAAQ;AAC1C;uCAEe","ignoreList":[0]}},
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["file:///Users/pushkardev/Development/numatix/apps/frontend/app/lib/auth.js"],"sourcesContent":["import { jwtDecode } from \"jwt-decode\";\nconst TOKEN_KEY = \"token\";\nconst USER_ID_KEY = \"userId\";\n\nexport function setToken(token) {\n    if (typeof window === \"undefined\") return;\n    localStorage.setItem(TOKEN_KEY, token);\n}\n\nexport function getToken() {\n    if (typeof window === \"undefined\") return null;\n    return localStorage.getItem(TOKEN_KEY);\n}\n\nexport function setUserId(userId) {\n    if (typeof window === \"undefined\") return;\n    if (!userId) return;\n    localStorage.setItem(USER_ID_KEY, String(userId));\n}\n\nexport function getUserId() {\n    if (typeof window === \"undefined\") return null;\n    return localStorage.getItem(USER_ID_KEY);\n}\n\nexport function clearAuth() {\n    if (typeof window === \"undefined\") return;\n    localStorage.removeItem(TOKEN_KEY);\n    localStorage.removeItem(USER_ID_KEY);\n}\n\n// Decode JWT payload (frontend-only, no verification)\nexport function decodeToken(tokenOverride) {\n    if (typeof window === \"undefined\") return null;\n\n    const token = tokenOverride || localStorage.getItem(\"token\");\n    if (!token) return null;\n\n    try {\n        return jwtDecode(token);\n    } catch (err) {\n        console.error(\"Failed to decode token:\", err);\n        return null;\n    }\n}"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;;AACA,MAAM,YAAY;AAClB,MAAM,cAAc;AAEb,SAAS,SAAS,KAAK;IAC1B;;IACA,aAAa,OAAO,CAAC,WAAW;AACpC;AAEO,SAAS;IACZ;;IACA,OAAO,aAAa,OAAO,CAAC;AAChC;AAEO,SAAS,UAAU,MAAM;IAC5B;;IACA,IAAI,CAAC,QAAQ;IACb,aAAa,OAAO,CAAC,aAAa,OAAO;AAC7C;AAEO,SAAS;IACZ;;IACA,OAAO,aAAa,OAAO,CAAC;AAChC;AAEO,SAAS;IACZ;;IACA,aAAa,UAAU,CAAC;IACxB,aAAa,UAAU,CAAC;AAC5B;AAGO,SAAS,YAAY,aAAa;IACrC;;IAEA,MAAM,QAAQ,iBAAiB,aAAa,OAAO,CAAC;IACpD,IAAI,CAAC,OAAO,OAAO;IAEnB,IAAI;QACA,OAAO,IAAA,sKAAS,EAAC;IACrB,EAAE,OAAO,KAAK;QACV,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO;IACX;AACJ"}},
    {"offset": {"line": 95, "column": 0}, "map": {"version":3,"sources":["file:///Users/pushkardev/Development/numatix/apps/frontend/app/trade/page.js"],"sourcesContent":["\"use client\";\n\nimport { Suspense, useEffect, useRef, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport Image from \"next/image\";\nimport { Inter } from \"next/font/google\";\nimport { z } from \"zod\";\nimport {\n    createChart,\n    CrosshairMode,\n    CandlestickSeries,\n} from \"lightweight-charts\";\n\nimport { MdDarkMode, MdOutlineLightMode } from \"react-icons/md\";\nimport { CgProfile } from \"react-icons/cg\";\n\nimport { getToken, getUserId } from \"../lib/auth\";\nimport \"dotenv/config\";\n\nconst inter = Inter({\n    subsets: [\"latin\"],\n    weight: [\"400\", \"500\", \"600\", \"700\"],\n});\n\nexport default function TradePage() {\n    const router = useRouter();\n    const userIdRef = useRef(null);\n    const [isProfileOpen, setIsProfileOpen] = useState(false);\n    const [status, setStatus] = useState(\"CONNECTING\");\n    const [apiMsg, setApiMsg] = useState(\"\");\n    const [isPlacingOrder, setIsPlacingOrder] = useState(false);\n    const [pendingOrderId, setPendingOrderId] = useState(null);\n    const [toast, setToast] = useState({ open: false, title: \"\", message: \"\", status: \"\" });\n\n    // orderId -> latest order status event\n    const [ordersById, setOrdersById] = useState({});\n\n    const ORDERS_PAGE_SIZE = 10;\n\n    const [ordersPage, setOrdersPage] = useState([]);     // current page rows from backend\n    const [ordersCursor, setOrdersCursor] = useState(null); // current cursor (orderId)\n    const [ordersNextCursor, setOrdersNextCursor] = useState(null);\n    const [ordersPrevStack, setOrdersPrevStack] = useState([]); // stack of previous cursors\n\n    const [ordersTotalEntries, setOrdersTotalEntries] = useState(0);\n    const [ordersTotalPages, setOrdersTotalPages] = useState(1);\n\n    const ordersCurrentPage = ordersPrevStack.length + 1;\n    const ordersIsFirstPage = ordersCurrentPage <= 1;\n    const ordersIsLastPage = ordersCurrentPage >= ordersTotalPages;\n\n    const [ordersLoading, setOrdersLoading] = useState(false);\n    const [ordersError, setOrdersError] = useState(\"\");\n\n    // positions (paginated)\n    const POSITIONS_PAGE_SIZE = 10;\n\n    const [positionsPage, setPositionsPage] = useState([]); // current page rows from backend\n    const [positionsCursor, setPositionsCursor] = useState(null); // cursor (Position.id)\n    const [positionsNextCursor, setPositionsNextCursor] = useState(null);\n    const [positionsPrevStack, setPositionsPrevStack] = useState([]);\n\n    const [positionsTotalEntries, setPositionsTotalEntries] = useState(0);\n    const [positionsTotalPages, setPositionsTotalPages] = useState(1);\n\n    const positionsCurrentPage = positionsPrevStack.length + 1;\n    const positionsIsFirstPage = positionsCurrentPage <= 1;\n    const positionsIsLastPage = positionsCurrentPage >= positionsTotalPages;\n\n    const [positionsLoading, setPositionsLoading] = useState(false);\n    const [positionsError, setPositionsError] = useState(\"\");\n\n    // balances\n    const [balances, setBalances] = useState([]); // [{ asset, free, locked }]\n    const [balancesLoading, setBalancesLoading] = useState(false);\n    const [balancesError, setBalancesError] = useState(\"\");\n    const [balancesUpdatedAt, setBalancesUpdatedAt] = useState(null);\n\n    // marketBoard: { BTCUSDT: { price, ts }, ETHUSDT: { ... } }\n    const [marketBoard, setMarketBoard] = useState({});\n    const [filter, setFilter] = useState(\"\");\n\n    const [lastEvent, setLastEvent] = useState(null);\n    const [lastUpdateTs, setLastUpdateTs] = useState(null);\n    const [pinned, setPinned] = useState(() => new Set());\n\n    // UI\n    const [theme, setTheme] = useState(() => {\n        if (typeof window === \"undefined\") return \"light\";\n        try {\n            const t = localStorage.getItem(\"theme\");\n            if (t === \"dark\" || t === \"light\") return t;\n        } catch { }\n        return \"light\";\n    }); // 'light' | 'dark'\n    const [activeTab, setActiveTab] = useState(\"trades\"); // positions | orders | trades\n    const [selectedSymbol, setSelectedSymbol] = useState(\"BTCUSDT\");\n    const [chartInterval, setChartInterval] = useState(\"1m\"); // 1m | 5m | 1d | 1w\n\n    const chartContainerRef = useRef(null);\n    const chartApiRef = useRef(null);\n    const candleSeriesRef = useRef(null);\n    const selectedSymbolRef = useRef(selectedSymbol);\n    const chartIntervalRef = useRef(chartInterval);\n\n    useEffect(() => {\n        selectedSymbolRef.current = selectedSymbol;\n    }, [selectedSymbol]);\n\n    useEffect(() => {\n        chartIntervalRef.current = chartInterval;\n    }, [chartInterval]);\n\n    const [side, setSide] = useState(\"BUY\");\n    const [orderType, setOrderType] = useState(\"MARKET\");\n    const [qty, setQty] = useState(\"0.01\");\n    const [limitPrice, setLimitPrice] = useState(\"\");\n    const [stopPrice, setStopPrice] = useState(\"\");\n    const [formErrors, setFormErrors] = useState({}); // { qty?: string, limitPrice?: string, stopPrice?: string, notional?: string, base?: string }\n\n    // Exchange symbol filters (LOT_SIZE etc)\n    const [symbolInfo, setSymbolInfo] = useState(null);\n    const [symbolInfoStatus, setSymbolInfoStatus] = useState(\"idle\"); // idle | loading | ready | error\n    const [symbolInfoError, setSymbolInfoError] = useState(\"\");\n\n    const UI_FLUSH_MS = Number(process.env.NEXT_PUBLIC_MARKET_FLUSH_MS || 1500);\n    const MAX_SYMBOLS = Number(process.env.NEXT_PUBLIC_MAX_SYMBOLS || 1000);\n\n    // Cache of latest prices by symbol\n    const latestBoardRef = useRef({});\n    // Stable insertion order for the table\n    const symbolOrderRef = useRef([]);\n    const latestTsRef = useRef(null);\n\n    const eventBaseUrl = (process.env.NEXT_PUBLIC_EVENT_SERVICE_URL || \"http://localhost:8081\").replace(/\\/$/, \"\");\n    const wsBaseUrl = (\n        process.env.NEXT_PUBLIC_WS_URL ||\n        eventBaseUrl.replace(/^https?:\\/\\//, (m) => (m === \"https://\" ? \"wss://\" : \"ws://\"))\n    ).replace(/\\/$/, \"\");\n    const apiBaseUrl = (process.env.NEXT_PUBLIC_API_URL || \"http://localhost:8080\").replace(/\\/$/, \"\");\n\n    useEffect(() => {\n        const token = getToken();\n        const userId = getUserId();\n        userIdRef.current = userId;\n        if (!token || !userId) {\n            router.push(\"/login\");\n            return;\n        }\n\n        // Initial balances fetch (account snapshot)\n        fetchBalances();\n    }, []);\n\n    const [wsMsgCount, setWsMsgCount] = useState(0);\n\n    useEffect(() => {\n        let ws;\n        let retryTimer;\n        let cancelled = false;\n        let attempt = 0;\n\n        const connect = () => {\n            if (cancelled) return;\n\n            const url = `${wsBaseUrl}/prices`;\n            try {\n                ws = new WebSocket(url);\n            } catch {\n                setStatus(\"ERROR\");\n                scheduleReconnect();\n                return;\n            }\n\n            ws.onopen = () => {\n                attempt = 0;\n                setStatus(\"OPEN\");\n            };\n\n            ws.onclose = () => {\n                setStatus(\"CLOSED\");\n                scheduleReconnect();\n            };\n\n            ws.onerror = () => {\n                setStatus(\"ERROR\");\n                // onerror is usually followed by close, but be safe\n            };\n\n            ws.onmessage = (e) => {\n                setWsMsgCount((c) => c + 1);\n\n                try {\n                    const outer = JSON.parse(e.data);\n                    setLastEvent(outer);\n\n                    // We expect: { type: 'REDIS_EVENT', channel, message, ts }\n                    if (outer?.type !== \"REDIS_EVENT\") return;\n\n                    const channel = outer.channel;\n                    let inner;\n                    try {\n                        inner = JSON.parse(outer.message);\n\n                        // Some channels publish JSON-stringified JSON (double encoding)\n                        if (typeof inner === \"string\") {\n                            try {\n                                inner = JSON.parse(inner);\n                            } catch {\n                                return; // not usable\n                            }\n                        }\n                    } catch {\n                        // If producers ever send non-JSON, ignore\n                        return;\n                    }\n\n                    // Price channel\n                    if (channel === \"events:price:update\") {\n                        if (inner?.type === \"MARKET_BOARD\" && Array.isArray(inner.data)) {\n                            const ts = inner.ts || outer.ts || Date.now();\n\n                            const board = latestBoardRef.current || {};\n                            const order = symbolOrderRef.current || [];\n                            const seen = new Set(order);\n\n                            for (const t of inner.data) {\n                                const symbol = t?.symbol ? String(t.symbol).toUpperCase() : \"\";\n                                if (!symbol) continue;\n                                const price = Number(t.price);\n                                if (!Number.isFinite(price)) continue;\n\n                                if (!seen.has(symbol)) {\n                                    if (order.length >= MAX_SYMBOLS) continue;\n                                    order.push(symbol);\n                                    seen.add(symbol);\n                                }\n\n                                board[symbol] = { price, ts };\n                            }\n\n                            latestBoardRef.current = board;\n                            symbolOrderRef.current = order;\n                            latestTsRef.current = ts;\n                            return;\n                        }\n\n                        if (inner?.type === \"PRICE_UPDATE\" && inner.symbol) {\n                            const price = Number(inner.price);\n                            if (!Number.isFinite(price)) return;\n\n                            const sym = String(inner.symbol).toUpperCase();\n                            const ts = inner.ts || outer.ts || Date.now();\n\n                            const board = latestBoardRef.current || {};\n                            const order = symbolOrderRef.current || [];\n\n                            if (!board[sym]) {\n                                if (order.length >= MAX_SYMBOLS) return;\n                                order.push(sym);\n                                symbolOrderRef.current = order;\n                            }\n\n                            board[sym] = { price, ts };\n                            latestBoardRef.current = board;\n                            latestTsRef.current = ts;\n                            return;\n                        }\n                    }\n\n                    // Order status channel\n                    if (channel === \"events:order:status\") {\n                        const ev = inner;\n                        // execution-service should publish the client order id as `orderId`.\n                        // If it publishes it under another key, accept those too.\n                        const orderId = ev?.orderId || ev?.clientOrderId || ev?.origClientOrderId || ev?.id;\n                        if (!orderId) return;\n\n                        setOrdersById((prev) => {\n                            const next = { ...prev };\n                            next[orderId] = { ...next[orderId], ...ev, orderId, updatedAt: Date.now() };\n\n                            const ids = Object.keys(next);\n                            if (ids.length > 1000) {\n                                ids.sort((a, b) => (next[a]?.updatedAt || 0) - (next[b]?.updatedAt || 0));\n                                const toDrop = ids.slice(0, ids.length - 1000);\n                                for (const id of toDrop) delete next[id];\n                            }\n                            return next;\n                        });\n\n                        // console.log(\"Received order status update for pending order:\", ev);\n                        if (pendingOrderId && String(orderId) === String(pendingOrderId)) {\n                            // if (true) {\n                            const st = String(ev?.status || \"\").toUpperCase();\n\n                            // Treat PARTIALLY_FILLED as \"done enough\" for UI: user should be able to close toast\n                            // and place another order if they want.\n                            const isFinalish = [\n                                \"FILLED\",\n                                \"REJECTED\",\n                                \"CANCELED\",\n                                \"CANCELLED\",\n                                \"EXPIRED\",\n                                \"PARTIALLY_FILLED\",\n                                \"NEW\",\n                                \"PENDING\",\n                                \"PENDING_CANCEL\",\n                            ].includes(st);\n\n                            setToast({\n                                open: true,\n                                title: isFinalish ? \"Order update\" : \"Order submitted\",\n                                status: st || \"PENDING\",\n                                message: `${ev?.side || \"\"} ${ev?.symbol || \"\"} • qty ${ev?.quantity ?? \"—\"}`.trim(),\n                            });\n\n                            if (isFinalish) {\n                                setIsPlacingOrder(false);\n                                setPendingOrderId(null);\n                            }\n                        }\n                    }\n\n                    // Account update channel (execution-service -> redis -> event-service -> WS)\n                    // Expected inner payload shapes:\n                    // - { type: 'ACCOUNT_UPDATE', balances: [...] }\n                    // - or { type: 'BALANCES', items: [...] }\n                    if (channel === \"events:account:update\") {\n                        const items = Array.isArray(inner?.balances)\n                            ? inner.balances\n                            : Array.isArray(inner?.items)\n                                ? inner.items\n                                : Array.isArray(inner?.data)\n                                    ? inner.data\n                                    : [];\n\n                        if (items.length) {\n                            setBalances(\n                                items\n                                    .map((b) => ({\n                                        asset: String(b.asset || \"\").toUpperCase(),\n                                        free: String(b.free ?? \"0\"),\n                                        locked: String(b.locked ?? \"0\"),\n                                    }))\n                                    .filter((b) => b.asset)\n                            );\n                            setBalancesUpdatedAt(Date.now());\n                            setBalancesError(\"\");\n                        }\n                        return;\n                    }\n\n                    if (channel === \"events:chart:update\") {\n                        const sym = String(inner?.symbol || \"\").toUpperCase();\n                        const itv = String(inner?.interval || \"\");\n                        if (!sym || sym !== String(selectedSymbolRef.current).toUpperCase()) return;\n                        if (itv && itv !== chartIntervalRef.current) return;\n\n                        const series = candleSeriesRef.current;\n                        if (!series) return;\n\n                        if (inner?.type === \"KLINE_SNAPSHOT\" && Array.isArray(inner?.candles) && inner?.symbol === selectedSymbolRef.current) {\n                            const bars = inner.candles\n                                .map(c => ({\n                                    time: Number(c.time),        // already seconds\n                                    open: Number(c.open),\n                                    high: Number(c.high),\n                                    low: Number(c.low),\n                                    close: Number(c.close),\n                                }))\n                                .filter(b =>\n                                    Number.isFinite(b.time) &&\n                                    Number.isFinite(b.open) &&\n                                    Number.isFinite(b.high) &&\n                                    Number.isFinite(b.low) &&\n                                    Number.isFinite(b.close)\n                                )\n                                .sort((a, b) => a.time - b.time);\n\n                            series.setData(bars);\n\n                            const chart = chartApiRef.current;\n                            if (chart) {\n                                chart.timeScale().scrollToRealTime();\n                                chart.timeScale().setVisibleLogicalRange({ from: 0, to: 10 });\n                            }\n\n\n                            return;\n                        }\n\n                        if (inner?.type === \"KLINE_UPDATE\" && inner?.symbol === selectedSymbolRef.current) {\n                            const k = inner?.kline || inner?.k || inner?.data;\n                            if (!k) return;\n\n                            const bar = {\n                                time: Math.floor(Number(k.startTime || k.time) / 1000),\n                                open: Number(k.open),\n                                high: Number(k.high),\n                                low: Number(k.low),\n                                close: Number(k.close),\n                            };\n\n                            if (\n                                !Number.isFinite(bar.time) ||\n                                !Number.isFinite(bar.open) ||\n                                !Number.isFinite(bar.high) ||\n                                !Number.isFinite(bar.low) ||\n                                !Number.isFinite(bar.close)\n                            ) return;\n\n                            series.update(bar);\n                            return;\n                        }\n                    }\n                } catch {\n                    // ignore parse errors\n                }\n            };\n        };\n\n        const scheduleReconnect = () => {\n            if (cancelled) return;\n            if (retryTimer) return;\n            attempt += 1;\n            const delay = Math.min(8000, 500 * attempt);\n            retryTimer = setTimeout(() => {\n                retryTimer = null;\n                connect();\n            }, delay);\n        };\n\n        connect();\n\n        return () => {\n            cancelled = true;\n            if (retryTimer) clearTimeout(retryTimer);\n            try {\n                ws?.close();\n            } catch { }\n        };\n    }, [wsBaseUrl, MAX_SYMBOLS, pendingOrderId]);\n\n    useEffect(() => {\n        try {\n            const raw = localStorage.getItem(\"pinnedSymbols\");\n            if (!raw) return;\n            const arr = JSON.parse(raw);\n            if (Array.isArray(arr)) setPinned(new Set(arr.map((s) => String(s).toUpperCase())));\n        } catch { }\n    }, []);\n\n    useEffect(() => {\n        try {\n            localStorage.setItem(\"pinnedSymbols\", JSON.stringify(Array.from(pinned)));\n        } catch { }\n    }, [pinned]);\n\n\n    useEffect(() => {\n        try {\n            localStorage.setItem(\"theme\", theme);\n        } catch { }\n\n        document.documentElement.style.colorScheme = theme;\n        if (theme === \"dark\") document.documentElement.classList.add(\"dark\");\n        else document.documentElement.classList.remove(\"dark\");\n    }, [theme]);\n\n    useEffect(() => {\n        // Flush latestBoardRef to state every UI_FLUSH_MS\n        const interval = setInterval(() => {\n            setMarketBoard({ ...latestBoardRef.current });\n            setLastUpdateTs(latestTsRef.current);\n        }, UI_FLUSH_MS);\n        return () => clearInterval(interval);\n    }, []);\n\n    useEffect(() => {\n        if (activeTab === \"orders\") {\n            fetchOrdersPage(ordersCursor);\n            return;\n        }\n        if (activeTab === \"positions\") {\n            fetchPositionsPage(positionsCursor);\n            return;\n        }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [activeTab, ordersCursor, positionsCursor]);\n    async function fetchPositionsPage(cursor = null) {\n        const token = getToken();\n        if (!token) {\n            router.push(\"/login\");\n            return;\n        }\n\n        setPositionsLoading(true);\n        setPositionsError(\"\");\n\n        try {\n            const qs = new URLSearchParams();\n            qs.set(\"limit\", String(POSITIONS_PAGE_SIZE));\n            if (cursor) qs.set(\"cursor\", String(cursor));\n\n            const res = await fetch(`${apiBaseUrl}/positions?${qs.toString()}`, {\n                method: \"GET\",\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                    Authorization: `Bearer ${token}`,\n                },\n                cache: \"no-store\",\n            });\n\n            const json = await res.json().catch(() => ({}));\n            if (!res.ok || json?.ok === false) {\n                throw new Error(json?.error || `Failed to fetch positions (${res.status})`);\n            }\n\n            const items = Array.isArray(json?.items)\n                ? json.items\n                : Array.isArray(json?.data)\n                    ? json.data\n                    : [];\n\n            setPositionsPage(items);\n\n            const nc =\n                json?.nextCursor ||\n                (items.length ? items[items.length - 1]?.id || null : null);\n\n            setPositionsNextCursor(nc || null);\n\n            const te = Number(json?.totalEntries);\n            const tp = Number(json?.totalPages);\n            if (Number.isFinite(te)) setPositionsTotalEntries(te);\n            if (Number.isFinite(tp) && tp > 0) setPositionsTotalPages(tp);\n        } catch (e) {\n            setPositionsError(e?.message || \"Failed to fetch positions\");\n            setPositionsPage([]);\n            setPositionsNextCursor(null);\n            setPositionsTotalEntries(0);\n            setPositionsTotalPages(1);\n        } finally {\n            setPositionsLoading(false);\n        }\n    }\n\n    function togglePin(sym) {\n        const s = String(sym).toUpperCase();\n        setPinned((prev) => {\n            const next = new Set(prev);\n            if (next.has(s)) next.delete(s);\n            else next.add(s);\n            return next;\n        });\n    }\n\n    async function copyOrderId(id) {\n        try {\n            await navigator.clipboard.writeText(String(id));\n            setApiMsg(\"Copied order id\");\n            setTimeout(() => setApiMsg(\"\"), 1200);\n        } catch {\n            setApiMsg(\"Could not copy\");\n            setTimeout(() => setApiMsg(\"\"), 1200);\n        }\n    }\n\n    function toggleTheme() {\n        setTheme((t) => (t === \"dark\" ? \"light\" : \"dark\"));\n    }\n\n    function formatPrice(p) {\n        if (!Number.isFinite(Number(p))) return \"—\";\n        return Number(p).toFixed(6).replace(/\\.?0+$/, \"\");\n    }\n\n    function asNumber(x) {\n        const n = Number(x);\n        return Number.isFinite(n) ? n : null;\n    }\n\n    function decimalsFromStep(step) {\n        const s = String(step);\n        const i = s.indexOf(\".\");\n        return i === -1 ? 0 : s.length - i - 1;\n    }\n\n    function roundToStep(value, step) {\n        const v = asNumber(value);\n        const st = asNumber(step);\n        if (v === null || st === null || st <= 0) return null;\n\n        const d = decimalsFromStep(step);\n        const scale = Math.pow(10, d);\n\n        // Convert to integers in \"step decimals\" space to avoid float remainder issues.\n        const stepInt = Math.round(st * scale);\n        if (!Number.isFinite(stepInt) || stepInt <= 0) return null;\n\n        // Snap DOWN to nearest step.\n        const vInt = Math.floor(v * scale + 1e-9); // tiny epsilon to counter float noise\n        const snappedInt = Math.floor(vInt / stepInt) * stepInt;\n        const out = snappedInt / scale;\n\n        return Number(out.toFixed(d));\n    }\n\n    function trimZeros(n) {\n        return String(n).replace(/\\.?0+$/, \"\");\n    }\n\n    function formatByStep(value, step) {\n        const v = asNumber(value);\n        const st = asNumber(step);\n        if (v === null) return \"—\";\n        if (st === null || st <= 0) return trimZeros(v);\n\n        const d = Math.min(decimalsFromStep(step), 8); // cap for UI\n        return trimZeros(Number(v).toFixed(d));\n    }\n\n    function validateNotional({ qtyNum, info, orderType, priceForNotional }) {\n        if (!info) return { ok: true };\n\n        const minN = asNumber(info.minNotional);\n        const maxN = asNumber(info.maxNotional);\n\n        const applyMinToMarket = Boolean(info.applyMinToMarket);\n        const applyMaxToMarket = Boolean(info.applyMaxToMarket);\n\n        const shouldApplyMin = orderType !== \"MARKET\" || applyMinToMarket;\n        const shouldApplyMax = orderType !== \"MARKET\" || applyMaxToMarket;\n\n        if (!shouldApplyMin && !shouldApplyMax) return { ok: true };\n\n        const p = asNumber(priceForNotional);\n        if (p === null || p <= 0) return { ok: true }; // can't validate w/out a price\n\n        const notional = p * qtyNum;\n\n        if (shouldApplyMin && minN !== null && notional < minN) {\n            return { ok: false, reason: `Notional too small: ${trimZeros(notional)} < min ${trimZeros(minN)} USDT` };\n        }\n        if (shouldApplyMax && maxN !== null && notional > maxN) {\n            return { ok: false, reason: `Notional too large: ${trimZeros(notional)} > max ${trimZeros(maxN)} USDT` };\n        }\n        return { ok: true };\n    }\n\n    function validateQty(q, info) {\n        const qn = asNumber(q);\n        if (qn === null || qn <= 0) return { ok: false, reason: \"Enter a valid quantity\" };\n        if (!info) return { ok: true };\n\n        const minQty = asNumber(info.minQty);\n        if (minQty !== null && qn < minQty) {\n            return { ok: false, reason: `Min qty is ${info.minQty}` };\n        }\n\n        const step = asNumber(info.stepSize);\n        if (step === null || step <= 0) return { ok: true };\n\n        const d = decimalsFromStep(info.stepSize);\n        const scale = Math.pow(10, d);\n\n        const stepInt = Math.round(step * scale);\n        if (!Number.isFinite(stepInt) || stepInt <= 0) return { ok: true };\n\n        // Integer-space divisibility check (prevents float false negatives)\n        const qtyInt = Math.round(qn * scale);\n        if (qtyInt % stepInt !== 0) {\n            return { ok: false, reason: `Qty must be a multiple of ${info.stepSize}` };\n        }\n\n        return { ok: true };\n    }\n\n    // Zod error mapping helper\n    function zodErrorMap(err) {\n        // Convert ZodError into a simple { field: message } map\n        const out = {};\n        for (const issue of err.issues || []) {\n            const key = (issue.path && issue.path.length ? issue.path[0] : \"base\") || \"base\";\n            if (!out[key]) out[key] = issue.message;\n        }\n        return out;\n    }\n\n    // Build a Zod schema for order form validation\n    function buildOrderSchema({ info, orderType, currentPrice }) {\n        // Accept strings from inputs; transform to numbers where needed\n        return z\n            .object({\n                qty: z\n                    .string()\n                    .trim()\n                    .min(1, \"Quantity is required\"),\n                limitPrice: z.string().trim().optional(),\n                stopPrice: z.string().trim().optional(),\n            })\n            .superRefine((val, ctx) => {\n                // Quantity\n                const qcheck = validateQty(val.qty, info);\n                if (!qcheck.ok) {\n                    ctx.addIssue({ code: z.ZodIssueCode.custom, path: [\"qty\"], message: qcheck.reason });\n                    return;\n                }\n\n                const qtyNum = Number(val.qty);\n\n                // Order-type specific price validation\n                let priceForNotional = currentPrice;\n\n                if (orderType === \"LIMIT\") {\n                    const p = Number(val.limitPrice);\n                    if (!Number.isFinite(p) || p <= 0) {\n                        ctx.addIssue({ code: z.ZodIssueCode.custom, path: [\"limitPrice\"], message: \"Enter a valid limit price\" });\n                        return;\n                    }\n                    priceForNotional = p;\n                }\n\n                if (orderType === \"STOP_LOSS\") {\n                    const sp = Number(val.stopPrice);\n                    if (!Number.isFinite(sp) || sp <= 0) {\n                        ctx.addIssue({ code: z.ZodIssueCode.custom, path: [\"stopPrice\"], message: \"Enter a valid stop price\" });\n                        return;\n                    }\n                    priceForNotional = sp;\n                }\n\n                // Notional validation (minNotional/maxNotional)\n                const ncheck = validateNotional({ qtyNum, info, orderType, priceForNotional });\n                if (!ncheck.ok) {\n                    // Show this as a general form error (not tied to one field)\n                    ctx.addIssue({ code: z.ZodIssueCode.custom, path: [\"notional\"], message: ncheck.reason });\n                    return;\n                }\n            });\n    }\n\n    async function fetchOrdersPage(cursor = null) {\n        const token = getToken();\n        if (!token) {\n            router.push(\"/login\");\n            return;\n        }\n\n        setOrdersLoading(true);\n        setOrdersError(\"\");\n\n        try {\n            const qs = new URLSearchParams();\n            qs.set(\"limit\", String(ORDERS_PAGE_SIZE));\n            if (cursor) qs.set(\"cursor\", String(cursor)); // orderId cursor\n\n            const res = await fetch(`${apiBaseUrl}/orders?${qs.toString()}`, {\n                method: \"GET\",\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                    Authorization: `Bearer ${token}`,\n                },\n                cache: \"no-store\",\n            });\n\n            const json = await res.json().catch(() => ({}));\n            if (!res.ok || json?.ok === false) {\n                throw new Error(json?.error || `Failed to fetch orders (${res.status})`);\n            }\n\n            // Expect: { ok: true, items: [...], nextCursor: \"...\" }\n            const items = Array.isArray(json?.items)\n                ? json.items\n                : Array.isArray(json?.data)\n                    ? json.data\n                    : [];\n\n            setOrdersPage(items);\n\n            const nc =\n                json?.nextCursor ||\n                (items.length ? items[items.length - 1]?.orderId || null : null);\n\n            setOrdersNextCursor(nc || null);\n\n            const te = Number(json?.totalEntries);\n            const tp = Number(json?.totalPages);\n            if (Number.isFinite(te)) setOrdersTotalEntries(te);\n            if (Number.isFinite(tp) && tp > 0) setOrdersTotalPages(tp);\n        } catch (e) {\n            setOrdersError(e?.message || \"Failed to fetch orders\");\n            setOrdersPage([]);\n            setOrdersNextCursor(null);\n            setOrdersTotalEntries(0);\n            setOrdersTotalPages(1);\n        } finally {\n            setOrdersLoading(false);\n        }\n    }\n\n    async function fetchBalances() {\n        const token = getToken();\n        if (!token) {\n            router.push(\"/login\");\n            return;\n        }\n\n        setBalancesLoading(true);\n        setBalancesError(\"\");\n\n        try {\n            // execution-service API (same auth as /orders, /positions)\n            const res = await fetch(`${apiBaseUrl}/api/trading/account`, {\n                method: \"GET\",\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                    Authorization: `Bearer ${token}`,\n                },\n                cache: \"no-store\",\n            });\n\n            const json = await res.json().catch(() => ({}));\n            if (!res.ok || json?.ok === false) {\n                throw new Error(json?.error || `Failed to fetch balances (${res.status})`);\n            }\n\n            const raw = Array.isArray(json?.balances)\n                ? json.balances\n                : Array.isArray(json?.account?.balances)\n                    ? json.account.balances\n                    : [];\n\n            const cleaned = raw\n                .map((b) => ({\n                    asset: String(b.asset || \"\").toUpperCase(),\n                    free: String(b.free ?? \"0\"),\n                    locked: String(b.locked ?? \"0\"),\n                }))\n                .filter((b) => b.asset);\n\n            setBalances(cleaned);\n            setBalancesUpdatedAt(Date.now());\n        } catch (e) {\n            setBalances([]);\n            setBalancesError(e?.message || \"Failed to fetch balances\");\n        } finally {\n            setBalancesLoading(false);\n        }\n    }\n\n    async function subscribeChart(symbol, interval) {\n        try {\n            await fetch(`${eventBaseUrl}/charts/subscribe`, {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({\n                    symbol: String(symbol || \"\").toUpperCase(),\n                    interval: String(interval || \"1m\"),\n                }),\n            });\n        } catch {\n            // ignore\n        }\n    }\n\n    const isDark = theme === \"dark\";\n\n\n    // 1) Create the chart ONCE (do not recreate on theme toggle)\n    useEffect(() => {\n        const el = chartContainerRef.current;\n        if (!el) return;\n\n        // Ensure the container is clean before mounting a new chart\n        try {\n            el.innerHTML = \"\";\n        } catch { }\n\n        // cleanup previous chart (defensive)\n        try {\n            chartApiRef.current?.remove?.();\n        } catch { }\n        chartApiRef.current = null;\n        candleSeriesRef.current = null;\n\n        const chart = createChart(el, {\n            autoSize: true,\n            crosshair: { mode: CrosshairMode.Normal },\n            timeScale: { timeVisible: true, secondsVisible: false },\n            layout: {\n                background: { color: \"#ffffff\" },\n                textColor: \"#334155\",\n            },\n            grid: {\n                vertLines: { color: \"#e2e8f0\" },\n                horzLines: { color: \"#e2e8f0\" },\n            },\n        });\n\n        const series = chart.addSeries(CandlestickSeries, {});\n        chartApiRef.current = chart;\n        candleSeriesRef.current = series;\n\n        return () => {\n            try {\n                chart.remove();\n            } catch { }\n            chartApiRef.current = null;\n            candleSeriesRef.current = null;\n        };\n    }, []);\n\n    // 2) Update chart colors when theme changes (do NOT wipe data)\n    useEffect(() => {\n        const chart = chartApiRef.current;\n        if (!chart) return;\n\n        chart.applyOptions({\n            layout: {\n                background: { color: isDark ? \"#020617\" : \"#ffffff\" },\n                textColor: isDark ? \"#cbd5e1\" : \"#334155\",\n            },\n            grid: {\n                vertLines: { color: isDark ? \"#0f172a\" : \"#e2e8f0\" },\n                horzLines: { color: isDark ? \"#0f172a\" : \"#e2e8f0\" },\n            },\n        });\n\n        // Optional: candle style tweaks for dark mode (keeps data intact)\n        const series = candleSeriesRef.current;\n        if (series?.applyOptions) {\n            series.applyOptions({\n                priceFormat: { type: \"price\", precision: 6, minMove: 0.000001 },\n            });\n        }\n    }, [isDark]);\n\n    useEffect(() => {\n        let cancelled = false;\n\n        async function fetchSymbolInfo() {\n            setSymbolInfoStatus(\"loading\");\n            setSymbolInfoError(\"\");\n\n            try {\n                const res = await fetch(\n                    `${eventBaseUrl}/symbol-info?symbol=${selectedSymbol}`\n                );\n                const json = await res.json();\n\n                if (!res.ok) throw new Error(json.error || \"Failed to load symbol info\");\n\n                if (!cancelled) {\n                    setSymbolInfo(json.data);\n                    setSymbolInfoStatus(\"ready\");\n\n                    // snap qty to step size\n                    const snapped = roundToStep(qty, json.data.stepSize);\n                    if (snapped !== null) setQty(String(snapped));\n                }\n            } catch (err) {\n                if (!cancelled) {\n                    setSymbolInfo(null);\n                    setSymbolInfoStatus(\"error\");\n                    setSymbolInfoError(err.message);\n                }\n            }\n        }\n\n        fetchSymbolInfo();\n        return () => (cancelled = true);\n    }, [selectedSymbol]);\n\n    useEffect(() => {\n        subscribeChart(selectedSymbol, chartInterval);\n        try {\n            candleSeriesRef.current?.setData([]);\n        } catch { }\n    }, [selectedSymbol, chartInterval]);\n\n    async function placeOrder() {\n        if (!userIdRef.current) {\n            setApiMsg(\"Not authenticated. Please login again.\");\n            router.push(\"/login\");\n            return;\n        }\n        setApiMsg(\"\");\n        setFormErrors({});\n        if (isPlacingOrder) return;\n        setIsPlacingOrder(true);\n\n        const schema = buildOrderSchema({ info: symbolInfo, orderType, currentPrice: asNumber(currentPrice) });\n        const parsed = schema.safeParse({\n            qty,\n            limitPrice,\n            stopPrice,\n        });\n\n        if (!parsed.success) {\n            const map = zodErrorMap(parsed.error);\n            setFormErrors(map);\n            // Also show a short message in apiMsg for visibility\n            setApiMsg(map.notional || map.qty || map.limitPrice || map.stopPrice || map.base || \"Fix the highlighted fields\");\n            setIsPlacingOrder(false);\n            return;\n        }\n\n        let qtyNum = Number(parsed.data.qty);\n        let limitPriceNum = orderType === \"LIMIT\" ? Number(parsed.data.limitPrice) : undefined;\n        let stopPriceNum = orderType === \"STOP_LOSS\" ? Number(parsed.data.stopPrice) : undefined;\n\n        // Snap inputs to exchange filters (stepSize, tickSize)\n        if (symbolInfo) {\n            if (symbolInfo.stepSize) {\n                const s = roundToStep(qtyNum, symbolInfo.stepSize);\n                if (s !== null) qtyNum = s;\n            }\n            if (symbolInfo.tickSize) {\n                if (limitPriceNum !== undefined) {\n                    const s = roundToStep(limitPriceNum, symbolInfo.tickSize);\n                    if (s !== null) limitPriceNum = s;\n                }\n                if (stopPriceNum !== undefined) {\n                    const s = roundToStep(stopPriceNum, symbolInfo.tickSize);\n                    if (s !== null) stopPriceNum = s;\n                }\n            }\n        }\n\n        setApiMsg(\"Placing order...\");\n        const clientOrderId =\n            typeof crypto !== \"undefined\" && crypto.randomUUID\n                ? crypto.randomUUID()\n                : `ord-${Date.now()}-${Math.random().toString(16).slice(2)}`;\n\n        setPendingOrderId(clientOrderId);\n        setToast({\n            open: true,\n            title: \"Placing order\",\n            status: \"PENDING\",\n            message: `${side} ${selectedSymbol} • qty ${qtyNum}`,\n        });\n\n        try {\n            const payload = {\n                orderId: clientOrderId,\n                userId: userIdRef.current,\n                symbol: String(selectedSymbol || \"\").toUpperCase(),\n                side: String(side || \"\").toUpperCase(),\n                orderType: String(orderType || \"MARKET\").toUpperCase(),\n                quantity: qtyNum,\n                meta: {},\n            };\n\n            // Keep fields explicit:\n            // - LIMIT uses `price` (+ timeInForce)\n            // - STOP_LOSS (Stop Market) uses `stopPrice`\n            if (orderType === \"LIMIT\") {\n                payload.price = limitPriceNum;\n                payload.timeInForce = \"GTC\";\n            } else if (orderType === \"STOP_LOSS\") {\n                payload.stopPrice = stopPriceNum;\n            }\n\n            const res = await fetch(`${eventBaseUrl}/orders`, {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify(payload),\n            });\n\n            const data = await res.json();\n            console.log(\"Place order response:\", data);\n            if (!res.ok || !data.ok) {\n                setIsPlacingOrder(false);\n                setApiMsg(data.error || \"Order failed\");\n                return;\n            }\n\n            setApiMsg(\"Order sent. Waiting for status...\");\n        } catch (e) {\n            setIsPlacingOrder(false);\n            setApiMsg(\"Network error\");\n        }\n    }\n\n    const f = filter.trim().toLowerCase();\n\n    // Keep table stable: insertion order + pinned coins on top\n    const orderedSymbols = symbolOrderRef.current;\n\n    const pinnedList = Array.from(pinned);\n    const pinnedSet = pinned;\n\n    const pinnedRows = pinnedList\n        .map((sym) => [sym, marketBoard[sym]])\n        .filter(([sym, v]) => v && (!f || sym.toLowerCase().includes(f)));\n\n    const regularRows = orderedSymbols\n        .filter((sym) => !pinnedSet.has(sym))\n        .map((sym) => [sym, marketBoard[sym]])\n        .filter(([sym, v]) => v && (!f || sym.toLowerCase().includes(f)));\n\n    const rows = [...pinnedRows, ...regularRows];\n    const shown = rows.slice(0, MAX_SYMBOLS);\n\n    // Derived rows (pinned first)\n    const totalSymbols = symbolOrderRef.current.length;\n\n    const currentPrice = marketBoard[selectedSymbol]?.price;\n\n    const priceLabel =\n        orderType === \"MARKET\" ? \"Price\" : orderType === \"STOP_LOSS\" ? \"Stop price\" : \"Limit price\";\n\n    const pricePlaceholder =\n        orderType === \"MARKET\"\n            ? \"Market price\"\n            : orderType === \"STOP_LOSS\"\n                ? \"Enter stop price\"\n                : \"Enter limit price\";\n\n    const priceValue =\n        orderType === \"MARKET\"\n            ? (Number.isFinite(Number(currentPrice)) ? String(currentPrice) : \"\")\n            : orderType === \"STOP_LOSS\"\n                ? stopPrice\n                : limitPrice;\n\n\n    return (\n        <main className={`${inter.className} min-h-screen w-full overflow-x-hidden transition-colors duration-200 ${isDark ? \"bg-[#09090b] text-neutral-200\" : \"bg-[#f5f5f5] text-neutral-900\"}`}>\n            {/* Topbar - Glassmorphism style */}\n            <div className={`sticky top-0 z-40 border-b backdrop-blur-md ${isDark ? \"bg-[#09090b]/80 border-white/10\" : \"bg-white/80 border-black/5\"}`}>\n                <div className=\"max-w-[1920px] mx-auto px-4 h-16 flex items-center justify-between\">\n                    <div className=\"flex items-center gap-4\">\n                        <div className=\"flex items-center gap-2 font-bold tracking-tighter text-lg\">\n                            <Image src=\"/logo.svg\" alt=\"Logo\" className=\"invert opacity-90\" width={150} height={100} />\n                        </div>\n                    </div>\n\n                    <div className=\"flex items-center gap-3\">\n                        {/* Live Indicator with Glow */}\n                        <div className={`hidden md:flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium border ${isDark ? \"bg-neutral-900/50 border-white/5 text-emerald-400\" : \"bg-white border-black/5 text-emerald-600\"}`}>\n                            <span className=\"relative flex h-2 w-2\">\n                                <span className=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75\"></span>\n                                <span className=\"relative inline-flex rounded-full h-2 w-2 bg-emerald-500\"></span>\n                            </span>\n                            Live\n                        </div>\n\n                        <div className=\"flex items-center  dark:bg-neutral-900 bg-neutral-100 rounded-full dark:border-white/5\">\n                            <button\n                                onClick={toggleTheme}\n                                className={`px-3 py-3 text-xs font-medium rounded-full transition-all ${isDark ? \"bg-neutral-800 text-white shadow-sm\" : \"text-neutral-500 hover:text-neutral-900 bg-white\"}`}\n                            >\n                                {isDark ? <MdDarkMode /> : <MdOutlineLightMode />}\n                            </button>\n                        </div>\n\n                        {/* <button className={`h-9 w-9 flex items-center justify-center rounded-full border transition-colors ${isDark ? \"bg-neutral-900 border-white/10 hover:bg-neutral-800 text-neutral-400\" : \"bg-white border-black/5 hover:bg-neutral-50 text-neutral-600\"}`}>\n                            <CgProfile />\n                        </button> */}\n                        {/* Profile Dropdown Container */}\n                        <div className=\"relative\">\n                            <button\n                                onClick={() => setIsProfileOpen(!isProfileOpen)}\n                                className={`h-9 w-9 flex items-center justify-center rounded-full border transition-all duration-200 ${isProfileOpen\n                                    ? (isDark ? \"bg-neutral-800 border-white/20 text-white\" : \"bg-neutral-100 border-black/10 text-black\")\n                                    : (isDark ? \"bg-neutral-900 border-white/10 hover:bg-neutral-800 text-neutral-400\" : \"bg-white border-black/5 hover:bg-neutral-50 text-neutral-600\")\n                                    }`}\n                            >\n                                <CgProfile className=\"text-lg\" />\n                            </button>\n\n                            {/* Dropdown Menu */}\n                            {isProfileOpen && (\n                                <div\n                                    className={`absolute right-0 mt-2 w-56 rounded-xl border shadow-xl backdrop-blur-sm z-50 transform origin-top-right transition-all ${isDark\n                                        ? \"bg-[#111]/95 border-white/10 text-neutral-200 shadow-black/50\"\n                                        : \"bg-white/95 border-black/5 text-neutral-700 shadow-neutral-200/50\"\n                                        }`}\n                                >\n                                    <div className=\"p-1.5 space-y-0.5\">\n                                        {/* Header / User Info (Optional) */}\n                                        <div className={`px-3 py-2 text-xs font-semibold uppercase tracking-wider ${isDark ? \"text-neutral-500\" : \"text-neutral-400\"}`}>\n                                            My Account\n                                        </div>\n\n                                        {/* Edit Details */}\n                                        <button\n                                            className={`w-full flex items-center gap-2 px-3 py-2 text-sm font-medium rounded-lg transition-colors ${isDark ? \"hover:bg-white/5 hover:text-white\" : \"hover:bg-neutral-100 hover:text-black\"\n                                                }`}\n                                            onClick={() => { alert(\"Coming soon!\"); }}\n\n                                        >\n                                            {/* Icon: FiEdit or similar */}\n                                            <svg className=\"w-4 h-4 opacity-70\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\" /></svg>\n                                            Edit Details\n                                        </button>\n\n                                        {/* Divider */}\n                                        <div className={`my-1 h-px ${isDark ? \"bg-white/5\" : \"bg-black/5\"}`}></div>\n\n                                        {/* Logout */}\n                                        <button\n                                            className=\"w-full flex items-center gap-2 px-3 py-2 text-sm font-medium rounded-lg text-rose-500 hover:bg-rose-500/10 transition-colors\"\n                                            onClick={() => {\n                                                router.push(\"/logout\");\n                                            }}\n                                        >\n                                            {/* Icon: FiLogOut or similar */}\n                                            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1\" /></svg>\n                                            Logout\n                                        </button>\n                                    </div>\n\n                                    {/* Footer Section: Close */}\n                                    <div className={`p-1.5 border-t ${isDark ? \"border-white/5 bg-white/5\" : \"border-black/5 bg-neutral-50/50\"}`}>\n                                        <button\n                                            onClick={() => setIsProfileOpen(false)}\n                                            className={`w-full flex items-center justify-center gap-2 px-3 py-1.5 text-xs font-semibold rounded-lg transition-colors ${isDark ? \"text-neutral-400 hover:text-white hover:bg-white/5\" : \"text-neutral-500 hover:text-black hover:bg-black/5\"\n                                                }`}\n                                        >\n                                            Close Menu\n                                        </button>\n                                    </div>\n                                </div>\n                            )}\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div className=\"max-w-[1920px] mx-auto p-4 lg:p-6\">\n                <h1 className=\"text-xl font-medium tracking-tight mb-6 px-1\">Portfolio & Trade</h1>\n\n                <div className=\"grid gap-6 lg:grid-cols-[380px_1fr]\">\n                    {/* Left Column: Controls */}\n                    <div className=\"space-y-6\">\n\n                        {/* Order Box */}\n                        <div className={`rounded-xl border overflow-hidden shadow-sm ${isDark ? \"bg-[#111] border-white/10\" : \"bg-white border-black/5\"}`}>\n                            <div className=\"p-5\">\n                                {/* Buy/Sell Segmented Control */}\n                                <div className={`grid grid-cols-2 gap-1 p-1 rounded-lg mb-6 ${isDark ? \"bg-neutral-900\" : \"bg-neutral-100\"}`}>\n                                    <button\n                                        onClick={() => setSide(\"BUY\")}\n                                        className={`py-2 text-sm font-semibold rounded-md transition-all ${side === \"BUY\"\n                                            ? (isDark ? \"bg-[#111] text-emerald-400 shadow-sm ring-1 ring-white/10\" : \"bg-white text-emerald-600 shadow-sm\")\n                                            : \"text-neutral-500 hover:text-neutral-400\"}`}\n                                    >\n                                        BUY\n                                    </button>\n                                    <button\n                                        onClick={() => {\n                                            setSide(\"SELL\");\n                                            if (orderType === \"STOP_LOSS\") setOrderType(\"MARKET\");\n                                        }}\n                                        className={`py-2 text-sm font-semibold rounded-md transition-all ${side === \"SELL\"\n                                            ? (isDark ? \"bg-[#111] text-rose-400 shadow-sm ring-1 ring-white/10\" : \"bg-white text-rose-600 shadow-sm\")\n                                            : \"text-neutral-500 hover:text-neutral-400\"}`}\n                                    >\n                                        SELL\n                                    </button>\n                                </div>\n\n                                {/* Order Type Tabs */}\n                                <div className=\"flex gap-4 border-b border-neutral-200 dark:border-white/5 mb-6 pb-2 overflow-x-auto\">\n                                    {[\"LIMIT\", \"MARKET\", \"STOP_LOSS\"].map((t) => {\n                                        if (side === \"SELL\" && t === \"STOP_LOSS\") return null;\n                                        const isActive = orderType === t;\n                                        return (\n                                            <button\n                                                key={t}\n                                                onClick={() => {\n                                                    setOrderType(t);\n                                                    if (t !== \"LIMIT\") setLimitPrice(\"\");\n                                                    if (t !== \"STOP_LOSS\") setStopPrice(\"\");\n                                                }}\n                                                className={`text-xs font-medium pb-2 -mb-2.5 border-b-2 transition-colors whitespace-nowrap ${isActive\n                                                    ? (isDark ? \"text-white border-white\" : \"text-black border-black\")\n                                                    : \"text-neutral-500 border-transparent hover:text-neutral-300\"}`}\n                                            >\n                                                {t === \"STOP_LOSS\" ? \"Stop Market\" : t[0] + t.slice(1).toLowerCase()}\n                                            </button>\n                                        );\n                                    })}\n                                </div>\n\n                                {/* Inputs */}\n                                <div className=\"space-y-4\">\n                                    <div>\n                                        <div className=\"flex justify-between text-xs mb-1.5 text-neutral-500\">\n                                            <span>{priceLabel}</span>\n                                        </div>\n                                        <div className={`flex items-center px-3 py-2.5 rounded-lg border transition-all ${isDark ? \"bg-[#09090b] border-white/10 focus-within:border-white/30\" : \"bg-neutral-50 border-neutral-200 focus-within:border-neutral-400\"}`}>\n                                            <input\n                                                className=\"bg-transparent text-sm w-full outline-none font-mono\"\n                                                placeholder={pricePlaceholder}\n                                                disabled={orderType === \"MARKET\"}\n                                                value={priceValue}\n                                                onChange={(e) => {\n                                                    const v = e.target.value;\n                                                    if (orderType === \"STOP_LOSS\") {\n                                                        setStopPrice(v);\n                                                        setFormErrors((prev) => ({ ...prev, stopPrice: undefined, notional: undefined }));\n                                                    } else if (orderType === \"LIMIT\") {\n                                                        setLimitPrice(v);\n                                                        setFormErrors((prev) => ({ ...prev, limitPrice: undefined, notional: undefined }));\n                                                    }\n                                                }}\n                                            />\n                                            <span className=\"text-xs text-neutral-500 font-medium\">USDT</span>\n                                        </div>\n                                        {/* Errors & Helpers */}\n                                        {orderType === \"MARKET\" && <div className=\"mt-1.5 text-xs text-neutral-500\">Executes at best price.</div>}\n                                        {(formErrors.limitPrice || formErrors.stopPrice || formErrors.notional) && (\n                                            <div className=\"mt-1.5 text-xs text-rose-500 font-medium\">{formErrors.limitPrice || formErrors.stopPrice || formErrors.notional}</div>\n                                        )}\n                                    </div>\n\n                                    <div className=\"grid grid-cols-2 gap-4\">\n                                        <div>\n                                            <div className=\"text-xs mb-1.5 text-neutral-500\">Quantity</div>\n                                            <div className={`flex items-center px-3 py-2.5 rounded-lg border transition-all ${isDark ? \"bg-[#09090b] border-white/10 focus-within:border-white/30\" : \"bg-neutral-50 border-neutral-200 focus-within:border-neutral-400\"}`}>\n                                                <input\n                                                    className=\"bg-transparent text-sm w-full outline-none font-mono\"\n                                                    value={qty}\n                                                    onChange={(e) => {\n                                                        setQty(e.target.value);\n                                                        setFormErrors((prev) => ({ ...prev, qty: undefined, notional: undefined }));\n                                                    }}\n                                                    placeholder=\"0.00\"\n                                                />\n                                                <span className=\"text-xs text-neutral-500 font-medium\">{selectedSymbol.replace(\"USDT\", \"\")}</span>\n                                            </div>\n                                            {formErrors.qty && <div className=\"mt-1.5 text-xs text-rose-500 font-medium\">{formErrors.qty}</div>}\n                                        </div>\n                                        <div>\n                                            <div className=\"text-xs mb-1.5 text-neutral-500\">Total</div>\n                                            <div className={`flex items-center px-3 py-2.5 rounded-lg border ${isDark ? \"bg-[#1a1a1a] border-white/5 text-neutral-500\" : \"bg-neutral-100 border-neutral-200 text-neutral-400\"}`}>\n                                                <input\n                                                    className=\"bg-transparent text-sm w-full outline-none font-mono cursor-default\"\n                                                    placeholder=\"0.00\"\n                                                    disabled\n                                                    value={`${formatPrice(currentPrice * Number(qty) || 0)}`}\n                                                    readOnly\n                                                />\n                                                <span className=\"text-xs opacity-70 font-medium\">USDT</span>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                    <div className=\"flex items-center justify-between py-2 text-xs\">\n                                        <span className=\"text-neutral-500\">Last Price</span>\n                                        <span className={`font-mono font-medium ${isDark ? \"text-white\" : \"text-black\"}`}>{formatPrice(currentPrice)}</span>\n                                    </div>\n\n                                    {symbolInfoStatus === \"error\" && (\n                                        <div className=\"text-xs text-rose-500 bg-rose-500/10 p-2 rounded\">{symbolInfoError}</div>\n                                    )}\n\n                                    <button\n                                        onClick={placeOrder}\n                                        disabled={isPlacingOrder}\n                                        className={`w-full py-3.5 text-sm font-bold rounded-lg transition-all transform active:scale-[0.98] ${isDark\n                                            ? \"bg-white text-black hover:bg-neutral-200 disabled:bg-neutral-800 disabled:text-neutral-500\"\n                                            : \"bg-black text-white hover:bg-neutral-800 disabled:bg-neutral-200 disabled:text-neutral-400\"\n                                            } ${isPlacingOrder ? \"cursor-not-allowed opacity-80\" : \"\"}`}\n                                    >\n                                        {isPlacingOrder ? \"Submitting...\" : (\n                                            <>\n                                                {side === \"BUY\" ? \"Buy\" : \"Sell\"} {selectedSymbol.replace(\"USDT\", \"\")}\n                                            </>\n                                        )}\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Account Summary */}\n                        <div className={`rounded-xl border shadow-sm p-5 ${isDark ? \"bg-[#111] border-white/10\" : \"bg-white border-black/5\"}`}>\n                            <div className=\"flex items-center justify-between mb-4\">\n                                <h3 className=\"text-sm font-semibold tracking-tight\">Assets</h3>\n                                <button\n                                    onClick={fetchBalances}\n                                    disabled={balancesLoading}\n                                    className={`p-1.5 rounded hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors ${balancesLoading ? \"animate-spin\" : \"\"}`}\n                                    title=\"Refresh balances\"\n                                >\n                                    <svg className={`w-3.5 h-3.5 ${isDark ? \"text-neutral-400\" : \"text-neutral-500\"}`} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" /></svg>\n                                </button>\n                            </div>\n\n                            {balancesError && <div className=\"text-xs text-rose-500 mb-3\">{balancesError}</div>}\n\n                            <div className=\"space-y-3 text-sm\">\n                                {(() => {\n                                    const byAsset = new Map(balances.map((b) => [b.asset, b]));\n                                    const usdt = byAsset.get(\"USDT\");\n                                    const usdtFree = usdt ? Number(usdt.free || 0) : 0;\n                                    const pinnedBases = Array.from(pinned).map((s) => String(s).toUpperCase().replace(/USDT$/, \"\")).filter((s) => s && s !== \"USDT\");\n                                    const uniqPinnedBases = Array.from(new Set(pinnedBases)).slice(0, 8);\n\n                                    return (\n                                        <>\n                                            <div className=\"flex items-center justify-between py-1\">\n                                                <div className=\"flex items-center gap-2\">\n                                                    <div className=\"w-5 h-5 rounded-full bg-emerald-500/20 flex items-center justify-center text-[10px] text-emerald-500 font-bold\">$</div>\n                                                    <span className=\"font-medium\">USDT</span>\n                                                </div>\n                                                <div className=\"text-right\">\n                                                    <div className=\"font-mono font-medium\">{trimZeros(usdtFree.toFixed(2))}</div>\n                                                </div>\n                                            </div>\n\n                                            {uniqPinnedBases.length > 0 && (\n                                                <div className=\"border-t border-dashed border-neutral-200 dark:border-white/10 pt-3 mt-3 space-y-3\">\n                                                    {uniqPinnedBases.map((asset) => {\n                                                        const b = byAsset.get(asset);\n                                                        const free = b ? Number(b.free || 0) : 0;\n                                                        const sym = `${asset}USDT`;\n                                                        const mark = Number(marketBoard[sym]?.price || 0);\n                                                        const est = Number.isFinite(mark) && mark > 0 ? free * mark : null;\n\n                                                        if (free === 0) return null;\n\n                                                        return (\n                                                            <div key={asset} className=\"flex items-center justify-between\">\n                                                                <button\n                                                                    onClick={() => setSelectedSymbol(sym)}\n                                                                    className=\"text-xs font-medium hover:text-emerald-500 transition-colors\"\n                                                                >\n                                                                    {asset}\n                                                                </button>\n                                                                <div className=\"text-right\">\n                                                                    <div className=\"font-mono text-xs\">{trimZeros(free.toFixed(4))}</div>\n                                                                    <div className=\"text-[10px] text-neutral-500\">\n                                                                        {est !== null ? `≈ $${formatPrice(est)}` : \"—\"}\n                                                                    </div>\n                                                                </div>\n                                                            </div>\n                                                        );\n                                                    })}\n                                                </div>\n                                            )}\n                                            {balancesUpdatedAt && <div className=\"pt-2 text-[10px] text-neutral-500 text-right\">Updated {new Date(balancesUpdatedAt).toLocaleTimeString()}</div>}\n                                        </>\n                                    );\n                                })()}\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Right Column: Chart & Data - Added min-w-0 for grid safety */}\n                    <div className=\"space-y-6 flex flex-col h-full min-h-0 w-full min-w-0\">\n                        {/* Chart Section */}\n                        <div className={`rounded-xl border shadow-sm flex flex-col ${isDark ? \"bg-[#111] border-white/10\" : \"bg-white border-black/5\"}`}>\n                            <div className=\"flex flex-wrap items-center justify-between p-4 border-b border-neutral-100 dark:border-white/5 gap-x-4 gap-y-4\">\n                                <div className=\"flex items-center gap-4\">\n                                    <h2 className=\"text-lg font-bold tracking-tight\">{selectedSymbol.replace(\"USDT\", \"\")}<span className=\"text-neutral-500 text-sm font-normal\">/USDT</span></h2>\n                                    <div className=\"h-4 w-[1px] bg-neutral-200 dark:bg-white/10\"></div>\n                                    <div className={`font-mono text-lg font-medium tracking-tight ${isDark ? \"text-white\" : \"text-neutral-900\"}`}>\n                                        {formatPrice(currentPrice)}\n                                    </div>\n                                </div>\n\n                                <div className={`flex rounded-lg overflow-hidden border ${isDark ? \"border-white/10 bg-neutral-900\" : \"border-neutral-200 bg-neutral-50\"}`}>\n                                    {[\"1m\", \"5m\", \"1d\", \"1w\"].map((t) => (\n                                        <button\n                                            key={t}\n                                            onClick={() => setChartInterval(t)}\n                                            className={`px-3 py-1.5 text-xs font-medium transition-colors ${t === chartInterval\n                                                ? (isDark ? \"bg-neutral-800 text-white\" : \"bg-white text-black shadow-sm\")\n                                                : \"text-neutral-500 hover:text-neutral-900 dark:hover:text-neutral-300\"}`}\n                                        >\n                                            {t}\n                                        </button>\n                                    ))}\n                                </div>\n                            </div>\n\n                            <div className=\"relative h-[400px] w-full p-1\">\n                                <div ref={chartContainerRef} className=\"w-full h-full\" />\n                            </div>\n                        </div>\n\n                        {/* Tabs & Table Section */}\n                        <div className={`flex-1 rounded-xl border shadow-sm flex flex-col min-h-[500px] ${isDark ? \"bg-[#111] border-white/10\" : \"bg-white border-black/5\"}`}>\n                            {/* Header: Flex col on mobile, row on desktop to prevent squashing */}\n                            <div className=\"flex flex-col md:flex-row md:items-center justify-between px-4 pt-4 pb-2 border-b border-neutral-100 dark:border-white/5 gap-4\">\n                                {/* Tabs Container: Added overflow-x-auto to handle many tabs on small screen */}\n                                <div className=\"flex gap-6 overflow-x-auto w-full md:w-auto pb-2 md:pb-0 scrollbar-hide\">\n                                    {[\n                                        { id: \"positions\", label: \"Open Positions\" },\n                                        { id: \"orders\", label: \"Order History\" },\n                                        { id: \"trades\", label: \"Market Trades\" },\n                                    ].map((t) => (\n                                        <button\n                                            key={t.id}\n                                            onClick={() => {\n                                                setActiveTab(t.id);\n                                                // Reset cursors logic\n                                                if (t.id === \"orders\") { setOrdersCursor(null); setOrdersNextCursor(null); setOrdersPrevStack([]); setOrdersTotalEntries(0); setOrdersTotalPages(1); }\n                                                if (t.id === \"positions\") { setPositionsError(\"\"); setPositionsCursor(null); setPositionsNextCursor(null); setPositionsPrevStack([]); setPositionsTotalEntries(0); setPositionsTotalPages(1); }\n                                            }}\n                                            className={`text-sm font-medium pb-3 border-b-2 transition-colors whitespace-nowrap ${activeTab === t.id\n                                                ? (isDark ? \"text-white border-emerald-500\" : \"text-black border-emerald-600\")\n                                                : \"text-neutral-500 border-transparent hover:text-neutral-400\"}`}\n                                        >\n                                            {t.label}\n                                        </button>\n                                    ))}\n                                </div>\n\n                                {activeTab === \"trades\" && (\n                                    <div className={`flex items-center px-2 py-1.5 rounded-md border w-full md:w-auto ${isDark ? \"bg-neutral-900 border-white/10\" : \"bg-neutral-50 border-neutral-200\"}`}>\n                                        <svg className=\"w-3 h-3 text-neutral-500 mr-2 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" /></svg>\n                                        <input\n                                            className=\"bg-transparent text-xs outline-none w-full md:w-32\"\n                                            value={filter}\n                                            onChange={(e) => setFilter(e.target.value)}\n                                            placeholder=\"Filter Symbol\"\n                                        />\n                                    </div>\n                                )}\n                            </div>\n\n                            <div className=\"flex-1 overflow-hidden relative\">\n                                <div className=\"absolute inset-0 overflow-auto custom-scrollbar\">\n                                    <table className=\"w-full text-sm text-left\">\n                                        <thead className={`sticky top-0 z-10 text-xs uppercase tracking-wider ${isDark ? \"bg-[#151515] text-neutral-500\" : \"bg-neutral-50 text-neutral-500\"}`}>\n                                            <tr>\n                                                {activeTab === \"positions\" && [\"Symbol\", \"Size\", \"Entry\", \"Mark\", \"Realized PnL\", \"Unrealized PnL\"].map(h => <th key={h} className=\"px-5 py-3 font-medium whitespace-nowrap\">{h}</th>)}\n                                                {activeTab === \"orders\" && [\"ID\", \"Symbol\", \"Side\", \"Type\", \"Qty\", \"Status\"].map(h => <th key={h} className=\"px-5 py-3 font-medium whitespace-nowrap\">{h}</th>)}\n                                                {activeTab === \"trades\" && [\"Pin\", \"Symbol\", \"Price\", \"Time\"].map(h => <th key={h} className=\"px-5 py-3 font-medium whitespace-nowrap\">{h}</th>)}\n                                            </tr>\n                                        </thead>\n                                        <tbody className=\"divide-y divide-neutral-100 dark:divide-white/5\">\n                                            {/* POSITIONS RENDER LOGIC */}\n                                            {activeTab === \"positions\" && (\n                                                positionsLoading ? <tr><td colSpan={6} className=\"px-5 py-8 text-center text-neutral-500\">Loading positions...</td></tr> :\n                                                    positionsError ? <tr><td colSpan={6} className=\"px-5 py-8 text-center text-rose-500\">{positionsError}</td></tr> :\n                                                        positionsPage.length === 0 ? <tr><td colSpan={6} className=\"px-5 py-8 text-center text-neutral-500\">No open positions</td></tr> :\n                                                            positionsPage.map(p => {\n                                                                const sym = String(p.symbol || \"\").toUpperCase();\n                                                                const realized = Number(p.realizedPnl || 0);\n                                                                const mark = Number(marketBoard[sym]?.price || 0);\n                                                                const entry = Number(p.avgPrice || 0);\n                                                                const qtyNum = Number(p.quantity || 0);\n                                                                const unrealized = (Number.isFinite(mark) && Number.isFinite(entry)) ? (mark - entry) * qtyNum : 0;\n\n                                                                return (\n                                                                    <tr key={p.id || `${p.userId}:${sym}`} className=\"hover:bg-neutral-50 dark:hover:bg-white/5 transition-colors\">\n                                                                        <td className=\"px-5 py-3 font-medium cursor-pointer hover:text-emerald-500\" onClick={() => setSelectedSymbol(sym)}>{sym}</td>\n                                                                        <td className=\"px-5 py-3 font-mono text-neutral-500\">{trimZeros(qtyNum.toFixed(6))}</td>\n                                                                        <td className=\"px-5 py-3 font-mono\">{trimZeros(entry.toFixed(6))}</td>\n                                                                        <td className=\"px-5 py-3 font-mono\">{formatPrice(mark)}</td>\n                                                                        <td className={`px-5 py-3 font-mono ${realized >= 0 ? \"text-emerald-500\" : \"text-rose-500\"}`}>{realized > 0 && \"+\"}{trimZeros(realized.toFixed(4))}</td>\n                                                                        <td className={`px-5 py-3 font-mono ${unrealized >= 0 ? \"text-emerald-500\" : \"text-rose-500\"}`}>{unrealized > 0 && \"+\"}{trimZeros(unrealized.toFixed(4))}</td>\n                                                                    </tr>\n                                                                )\n                                                            })\n                                            )}\n\n                                            {/* ORDERS RENDER LOGIC */}\n                                            {activeTab === \"orders\" && (\n                                                ordersLoading ? <tr><td colSpan={6} className=\"px-5 py-8 text-center text-neutral-500\">Loading orders...</td></tr> :\n                                                    ordersPage.length === 0 ? <tr><td colSpan={6} className=\"px-5 py-8 text-center text-neutral-500\">No order history</td></tr> :\n                                                        ordersPage.map(o => (\n                                                            <tr key={o.orderId} className=\"hover:bg-neutral-50 dark:hover:bg-white/5 transition-colors\">\n                                                                <td className=\"px-5 py-3 font-mono text-xs text-neutral-500 flex items-center gap-2\">\n                                                                    {String(o.orderId).slice(0, 8)}...\n                                                                    <CopyOrderButton orderId={o.orderId} isDark={isDark} onCopy={copyOrderId} />\n                                                                </td>\n                                                                <td className=\"px-5 py-3 font-medium cursor-pointer hover:text-emerald-500\" onClick={() => setSelectedSymbol(o.symbol)}>{o.symbol}</td>\n                                                                <td className=\"px-5 py-3\">\n                                                                    <span className={`text-xs font-bold px-1.5 py-0.5 rounded ${o.side === \"BUY\" ? \"bg-emerald-500/10 text-emerald-500\" : \"bg-rose-500/10 text-rose-500\"}`}>\n                                                                        {o.side}\n                                                                    </span>\n                                                                </td>\n                                                                <td className=\"px-5 py-3 text-neutral-500 text-xs\">{o.orderType}</td>\n                                                                <td className=\"px-5 py-3 font-mono\">{o.quantity}</td>\n                                                                <td className=\"px-5 py-3 text-xs font-medium\">\n                                                                    <span className={`px-2 py-1 rounded border ${(ordersById[o.orderId]?.status || o.status) === \"FILLED\" ? \"border-emerald-500/20 text-emerald-500 bg-emerald-500/5\" :\n                                                                        (ordersById[o.orderId]?.status || o.status) === \"CANCELED\" ? \"border-neutral-500/20 text-neutral-500\" :\n                                                                            \"border-yellow-500/20 text-yellow-500 bg-yellow-500/5\"\n                                                                        }`}>\n                                                                        {ordersById[o.orderId]?.status || o.status}\n                                                                    </span>\n                                                                </td>\n                                                            </tr>\n                                                        ))\n                                            )}\n\n                                            {/* TRADES RENDER LOGIC */}\n                                            {activeTab === \"trades\" && (\n                                                shown.length === 0 ? <tr><td colSpan={4} className=\"px-5 py-8 text-center text-neutral-500\">Waiting for market data...</td></tr> :\n                                                    shown.map(([sym, v]) => (\n                                                        <tr key={sym} className=\"hover:bg-neutral-50 dark:hover:bg-white/5 transition-colors\">\n                                                            <td className=\"px-5 py-3\">\n                                                                <button onClick={() => togglePin(sym)} className={`text-sm ${pinned.has(sym) ? \"text-amber-400\" : \"text-neutral-600 dark:text-neutral-600 hover:text-neutral-400\"}`}>\n                                                                    {pinned.has(sym) ? \"★\" : \"☆\"}\n                                                                </button>\n                                                            </td>\n                                                            <td className=\"px-5 py-3 font-medium cursor-pointer hover:text-emerald-500\" onClick={() => setSelectedSymbol(sym)}>{sym}</td>\n                                                            <td className=\"px-5 py-3 font-mono\">{formatPrice(v.price)}</td>\n                                                            <td className=\"px-5 py-3 text-xs text-neutral-500 tabular-nums\">{v.ts ? new Date(v.ts).toLocaleTimeString() : \"-\"}</td>\n                                                        </tr>\n                                                    ))\n                                            )}\n                                        </tbody>\n                                    </table>\n                                </div>\n                            </div>\n\n                            {/* Footer / Pagination */}\n                            {(activeTab === \"positions\" || activeTab === \"orders\") && (\n                                <div\n                                    className={`flex items-center justify-between p-2 border-t ${isDark ? \"border-white/10\" : \"border-black/5\"}`}>\n\n                                    <div className=\"text-xs text-neutral-500\">\n                                        {activeTab === \"positions\" ? positionsTotalEntries : ordersTotalEntries} items\n                                    </div>\n                                    <div className=\"flex gap-2\">\n                                        <button\n                                            className={`p-1.5 rounded-md border disabled:opacity-30 ${isDark ? \"border-white/10 hover:bg-neutral-800\" : \"border-neutral-200 hover:bg-white\"}`}\n                                            onClick={() => activeTab === \"positions\" ? fetchPositionsPage(positionsCursor) : fetchOrdersPage(ordersCursor)}\n                                            disabled={activeTab === \"positions\" ? positionsLoading : ordersLoading}\n                                        >\n                                            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" /></svg>\n                                        </button>\n                                        <button\n                                            className={`p-1.5 rounded-md border disabled:opacity-30 ${isDark ? \"border-white/10 hover:bg-neutral-800\" : \"border-neutral-200 hover:bg-white\"}`}\n                                            disabled={(activeTab === \"positions\" ? positionsPrevStack.length === 0 : ordersPrevStack.length === 0)}\n                                            onClick={() => {\n                                                if (activeTab === \"positions\") {\n                                                    setPositionsPrevStack(prev => {\n                                                        const next = [...prev];\n                                                        setPositionsCursor(next.pop() || null);\n                                                        return next;\n                                                    });\n                                                } else {\n                                                    setOrdersPrevStack(prev => {\n                                                        const next = [...prev];\n                                                        setOrdersCursor(next.pop() || null);\n                                                        return next;\n                                                    });\n                                                }\n                                            }}\n                                        >\n                                            <FiArrowLeft className=\"w-4 h-4\" />\n                                        </button>\n                                        <span className=\"text-xs flex items-center px-2 text-neutral-500\">\n                                            Page {activeTab === \"positions\" ? positionsCurrentPage : ordersCurrentPage}\n                                        </span>\n                                        <button\n                                            className={`p-1.5 rounded-md border disabled:opacity-30 ${isDark ? \"border-white/10 hover:bg-neutral-800\" : \"border-neutral-200 hover:bg-white\"}`}\n                                            disabled={activeTab === \"positions\" ? (!positionsNextCursor || positionsIsLastPage) : (!ordersNextCursor || ordersIsLastPage)}\n                                            onClick={() => {\n                                                if (activeTab === \"positions\" && positionsNextCursor) {\n                                                    setPositionsPrevStack(p => [...p, positionsCursor]);\n                                                    setPositionsCursor(positionsNextCursor);\n                                                } else if (activeTab === \"orders\" && ordersNextCursor) {\n                                                    setOrdersPrevStack(p => [...p, ordersCursor]);\n                                                    setOrdersCursor(ordersNextCursor);\n                                                }\n                                            }}\n                                        >\n                                            <FiArrowRight className=\"w-4 h-4\" />\n                                        </button>\n                                    </div>\n                                </div>\n                            )}\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            {/* Toast Modal - Styled Premium */}\n            {toast.open && (\n                <div className=\"fixed inset-0 z-50 flex items-end sm:items-center justify-center p-4 sm:p-0\">\n                    <div className=\"absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity\" onClick={() => !isPlacingOrder && setToast(t => ({ ...t, open: false }))} />\n                    <div className={`relative w-full max-w-sm rounded-2xl border shadow-2xl overflow-hidden transform transition-all ${isDark ? \"bg-[#111] border-white/10\" : \"bg-white border-black/5\"}`}>\n                        <div className={`h-1.5 w-full ${toast.status === \"FILLED\" ? \"bg-emerald-500\" : toast.status === \"REJECTED\" ? \"bg-rose-500\" : \"bg-neutral-500\"}`}></div>\n                        <div className=\"p-6\">\n                            <h3 className=\"text-lg font-bold tracking-tight mb-1\">{toast.title}</h3>\n                            <p className={`text-sm mb-4 ${isDark ? \"text-neutral-400\" : \"text-neutral-500\"}`}>{toast.message}</p>\n\n                            <div className=\"flex gap-3 mt-6\">\n                                <button\n                                    onClick={() => { setActiveTab(\"orders\"); setToast(t => ({ ...t, open: false })); }}\n                                    className={`flex-1 py-2.5 text-sm font-medium rounded-lg border ${isDark ? \"border-white/10 hover:bg-white/5\" : \"border-neutral-200 hover:bg-neutral-50\"}`}\n                                >\n                                    View Order\n                                </button>\n                                <button\n                                    onClick={() => setToast(t => ({ ...t, open: false }))}\n                                    className={`flex-1 py-2.5 text-sm font-bold rounded-lg ${isDark ? \"bg-white text-black hover:bg-neutral-200\" : \"bg-black text-white hover:bg-neutral-800\"}`}\n                                >\n                                    Dismiss\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            )}\n        </main>\n    );\n}\n\n\nimport { FiCopy, FiCheck, FiArrowRight, FiArrowLeft, FiSun } from \"react-icons/fi\";\nimport { Fi } from \"zod/v4/locales\";\n\nconst CopyOrderButton = ({ orderId, isDark, onCopy }) => {\n    const [copied, setCopied] = useState(false);\n\n    const handleClick = () => {\n        // 1. Perform the actual copy action\n        if (onCopy) {\n            onCopy(orderId);\n        } else {\n            // Fallback if no function passed\n            navigator.clipboard.writeText(orderId);\n        }\n\n        // 2. Trigger the icon change\n        setCopied(true);\n\n        // 3. Revert back after 2 seconds\n        setTimeout(() => {\n            setCopied(false);\n        }, 2000);\n    };\n\n    return (\n        <button\n            type=\"button\"\n            onClick={handleClick}\n            className={`p-1 rounded transition-all duration-200 ${isDark\n                ? \"hover:bg-slate-800\"\n                : \"hover:bg-slate-200\"\n                } ${copied\n                    ? \"text-emerald-500 scale-110\" // Green and slightly larger when copied\n                    : isDark ? \"text-slate-400\" : \"text-slate-500\"\n                }`}\n            title={copied ? \"Copied!\" : \"Copy order id\"}\n        >\n            {copied ? <FiCheck className=\"w-4 h-4\" /> : <FiCopy className=\"w-4 h-4\" />}\n        </button>\n    );\n};"],"names":[],"mappings":";;;;AA6H+B;;AA3H/B;AACA;AACA;;AAEA;AACA;AAMA;AACA;AAEA;AACA;AAkqDA;AACA;;;AAprDA;;;;;;;;;;;AAwBe,SAAS;;IACpB,MAAM,SAAS,IAAA,sKAAS;IACxB,MAAM,YAAY,IAAA,2LAAM,EAAC;IACzB,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,6LAAQ,EAAC;IACnD,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,6LAAQ,EAAC;IACrC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,6LAAQ,EAAC;IACrC,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,6LAAQ,EAAC;IACrD,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,6LAAQ,EAAC;IACrD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6LAAQ,EAAC;QAAE,MAAM;QAAO,OAAO;QAAI,SAAS;QAAI,QAAQ;IAAG;IAErF,uCAAuC;IACvC,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,6LAAQ,EAAC,CAAC;IAE9C,MAAM,mBAAmB;IAEzB,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,6LAAQ,EAAC,EAAE,GAAO,iCAAiC;IACvF,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,6LAAQ,EAAC,OAAO,2BAA2B;IACnF,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,6LAAQ,EAAC;IACzD,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,6LAAQ,EAAC,EAAE,GAAG,4BAA4B;IAExF,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,6LAAQ,EAAC;IAC7D,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,6LAAQ,EAAC;IAEzD,MAAM,oBAAoB,gBAAgB,MAAM,GAAG;IACnD,MAAM,oBAAoB,qBAAqB;IAC/C,MAAM,mBAAmB,qBAAqB;IAE9C,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,6LAAQ,EAAC;IACnD,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,6LAAQ,EAAC;IAE/C,wBAAwB;IACxB,MAAM,sBAAsB;IAE5B,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,6LAAQ,EAAC,EAAE,GAAG,iCAAiC;IACzF,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,6LAAQ,EAAC,OAAO,uBAAuB;IACrF,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,IAAA,6LAAQ,EAAC;IAC/D,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,6LAAQ,EAAC,EAAE;IAE/D,MAAM,CAAC,uBAAuB,yBAAyB,GAAG,IAAA,6LAAQ,EAAC;IACnE,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,IAAA,6LAAQ,EAAC;IAE/D,MAAM,uBAAuB,mBAAmB,MAAM,GAAG;IACzD,MAAM,uBAAuB,wBAAwB;IACrD,MAAM,sBAAsB,wBAAwB;IAEpD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,6LAAQ,EAAC;IACzD,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,6LAAQ,EAAC;IAErD,WAAW;IACX,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,6LAAQ,EAAC,EAAE,GAAG,4BAA4B;IAC1E,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,6LAAQ,EAAC;IACvD,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,6LAAQ,EAAC;IACnD,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,6LAAQ,EAAC;IAE3D,4DAA4D;IAC5D,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,6LAAQ,EAAC,CAAC;IAChD,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,6LAAQ,EAAC;IAErC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,6LAAQ,EAAC;IAC3C,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,6LAAQ,EAAC;IACjD,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,6LAAQ;8BAAC,IAAM,IAAI;;IAE/C,KAAK;IACL,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6LAAQ;8BAAC;YAC/B;;YACA,IAAI;gBACA,MAAM,IAAI,aAAa,OAAO,CAAC;gBAC/B,IAAI,MAAM,UAAU,MAAM,SAAS,OAAO;YAC9C,EAAE,OAAM,CAAE;YACV,OAAO;QACX;8BAAI,mBAAmB;IACvB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,6LAAQ,EAAC,WAAW,8BAA8B;IACpF,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,6LAAQ,EAAC;IACrD,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,6LAAQ,EAAC,OAAO,oBAAoB;IAE9E,MAAM,oBAAoB,IAAA,2LAAM,EAAC;IACjC,MAAM,cAAc,IAAA,2LAAM,EAAC;IAC3B,MAAM,kBAAkB,IAAA,2LAAM,EAAC;IAC/B,MAAM,oBAAoB,IAAA,2LAAM,EAAC;IACjC,MAAM,mBAAmB,IAAA,2LAAM,EAAC;IAEhC,IAAA,8LAAS;+BAAC;YACN,kBAAkB,OAAO,GAAG;QAChC;8BAAG;QAAC;KAAe;IAEnB,IAAA,8LAAS;+BAAC;YACN,iBAAiB,OAAO,GAAG;QAC/B;8BAAG;QAAC;KAAc;IAElB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,6LAAQ,EAAC;IACjC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,6LAAQ,EAAC;IAC3C,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,6LAAQ,EAAC;IAC/B,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,6LAAQ,EAAC;IAC7C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,6LAAQ,EAAC;IAC3C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,6LAAQ,EAAC,CAAC,IAAI,8FAA8F;IAEhJ,yCAAyC;IACzC,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,6LAAQ,EAAC;IAC7C,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,6LAAQ,EAAC,SAAS,iCAAiC;IACnG,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,6LAAQ,EAAC;IAEvD,MAAM,cAAc,OAAO,+LAAO,CAAC,GAAG,CAAC,2BAA2B,IAAI;IACtE,MAAM,cAAc,OAAO,+LAAO,CAAC,GAAG,CAAC,uBAAuB,IAAI;IAElE,mCAAmC;IACnC,MAAM,iBAAiB,IAAA,2LAAM,EAAC,CAAC;IAC/B,uCAAuC;IACvC,MAAM,iBAAiB,IAAA,2LAAM,EAAC,EAAE;IAChC,MAAM,cAAc,IAAA,2LAAM,EAAC;IAE3B,MAAM,eAAe,CAAC,qEAA6C,uBAAuB,EAAE,OAAO,CAAC,OAAO;IAC3G,MAAM,YAAY,CACd,+LAAO,CAAC,GAAG,CAAC,kBAAkB,IAC9B,aAAa,OAAO,CAAC,gBAAgB,CAAC,IAAO,MAAM,aAAa,WAAW,QAC/E,EAAE,OAAO,CAAC,OAAO;IACjB,MAAM,aAAa,CAAC,kEAAmC,uBAAuB,EAAE,OAAO,CAAC,OAAO;IAE/F,IAAA,8LAAS;+BAAC;YACN,MAAM,QAAQ,IAAA,qJAAQ;YACtB,MAAM,SAAS,IAAA,sJAAS;YACxB,UAAU,OAAO,GAAG;YACpB,IAAI,CAAC,SAAS,CAAC,QAAQ;gBACnB,OAAO,IAAI,CAAC;gBACZ;YACJ;YAEA,4CAA4C;YAC5C;QACJ;8BAAG,EAAE;IAEL,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,6LAAQ,EAAC;IAE7C,IAAA,8LAAS;+BAAC;YACN,IAAI;YACJ,IAAI;YACJ,IAAI,YAAY;YAChB,IAAI,UAAU;YAEd,MAAM;+CAAU;oBACZ,IAAI,WAAW;oBAEf,MAAM,MAAM,GAAG,UAAU,OAAO,CAAC;oBACjC,IAAI;wBACA,KAAK,IAAI,UAAU;oBACvB,EAAE,OAAM;wBACJ,UAAU;wBACV;wBACA;oBACJ;oBAEA,GAAG,MAAM;uDAAG;4BACR,UAAU;4BACV,UAAU;wBACd;;oBAEA,GAAG,OAAO;uDAAG;4BACT,UAAU;4BACV;wBACJ;;oBAEA,GAAG,OAAO;uDAAG;4BACT,UAAU;wBACV,oDAAoD;wBACxD;;oBAEA,GAAG,SAAS;uDAAG,CAAC;4BACZ;+DAAc,CAAC,IAAM,IAAI;;4BAEzB,IAAI;gCACA,MAAM,QAAQ,KAAK,KAAK,CAAC,EAAE,IAAI;gCAC/B,aAAa;gCAEb,2DAA2D;gCAC3D,IAAI,OAAO,SAAS,eAAe;gCAEnC,MAAM,UAAU,MAAM,OAAO;gCAC7B,IAAI;gCACJ,IAAI;oCACA,QAAQ,KAAK,KAAK,CAAC,MAAM,OAAO;oCAEhC,gEAAgE;oCAChE,IAAI,OAAO,UAAU,UAAU;wCAC3B,IAAI;4CACA,QAAQ,KAAK,KAAK,CAAC;wCACvB,EAAE,OAAM;4CACJ,QAAQ,aAAa;wCACzB;oCACJ;gCACJ,EAAE,OAAM;oCACJ,0CAA0C;oCAC1C;gCACJ;gCAEA,gBAAgB;gCAChB,IAAI,YAAY,uBAAuB;oCACnC,IAAI,OAAO,SAAS,kBAAkB,MAAM,OAAO,CAAC,MAAM,IAAI,GAAG;wCAC7D,MAAM,KAAK,MAAM,EAAE,IAAI,MAAM,EAAE,IAAI,KAAK,GAAG;wCAE3C,MAAM,QAAQ,eAAe,OAAO,IAAI,CAAC;wCACzC,MAAM,QAAQ,eAAe,OAAO,IAAI,EAAE;wCAC1C,MAAM,OAAO,IAAI,IAAI;wCAErB,KAAK,MAAM,KAAK,MAAM,IAAI,CAAE;4CACxB,MAAM,SAAS,GAAG,SAAS,OAAO,EAAE,MAAM,EAAE,WAAW,KAAK;4CAC5D,IAAI,CAAC,QAAQ;4CACb,MAAM,QAAQ,OAAO,EAAE,KAAK;4CAC5B,IAAI,CAAC,OAAO,QAAQ,CAAC,QAAQ;4CAE7B,IAAI,CAAC,KAAK,GAAG,CAAC,SAAS;gDACnB,IAAI,MAAM,MAAM,IAAI,aAAa;gDACjC,MAAM,IAAI,CAAC;gDACX,KAAK,GAAG,CAAC;4CACb;4CAEA,KAAK,CAAC,OAAO,GAAG;gDAAE;gDAAO;4CAAG;wCAChC;wCAEA,eAAe,OAAO,GAAG;wCACzB,eAAe,OAAO,GAAG;wCACzB,YAAY,OAAO,GAAG;wCACtB;oCACJ;oCAEA,IAAI,OAAO,SAAS,kBAAkB,MAAM,MAAM,EAAE;wCAChD,MAAM,QAAQ,OAAO,MAAM,KAAK;wCAChC,IAAI,CAAC,OAAO,QAAQ,CAAC,QAAQ;wCAE7B,MAAM,MAAM,OAAO,MAAM,MAAM,EAAE,WAAW;wCAC5C,MAAM,KAAK,MAAM,EAAE,IAAI,MAAM,EAAE,IAAI,KAAK,GAAG;wCAE3C,MAAM,QAAQ,eAAe,OAAO,IAAI,CAAC;wCACzC,MAAM,QAAQ,eAAe,OAAO,IAAI,EAAE;wCAE1C,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE;4CACb,IAAI,MAAM,MAAM,IAAI,aAAa;4CACjC,MAAM,IAAI,CAAC;4CACX,eAAe,OAAO,GAAG;wCAC7B;wCAEA,KAAK,CAAC,IAAI,GAAG;4CAAE;4CAAO;wCAAG;wCACzB,eAAe,OAAO,GAAG;wCACzB,YAAY,OAAO,GAAG;wCACtB;oCACJ;gCACJ;gCAEA,uBAAuB;gCACvB,IAAI,YAAY,uBAAuB;oCACnC,MAAM,KAAK;oCACX,qEAAqE;oCACrE,0DAA0D;oCAC1D,MAAM,UAAU,IAAI,WAAW,IAAI,iBAAiB,IAAI,qBAAqB,IAAI;oCACjF,IAAI,CAAC,SAAS;oCAEd;uEAAc,CAAC;4CACX,MAAM,OAAO;gDAAE,GAAG,IAAI;4CAAC;4CACvB,IAAI,CAAC,QAAQ,GAAG;gDAAE,GAAG,IAAI,CAAC,QAAQ;gDAAE,GAAG,EAAE;gDAAE;gDAAS,WAAW,KAAK,GAAG;4CAAG;4CAE1E,MAAM,MAAM,OAAO,IAAI,CAAC;4CACxB,IAAI,IAAI,MAAM,GAAG,MAAM;gDACnB,IAAI,IAAI;mFAAC,CAAC,GAAG,IAAM,CAAC,IAAI,CAAC,EAAE,EAAE,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,EAAE,aAAa,CAAC;;gDACvE,MAAM,SAAS,IAAI,KAAK,CAAC,GAAG,IAAI,MAAM,GAAG;gDACzC,KAAK,MAAM,MAAM,OAAQ,OAAO,IAAI,CAAC,GAAG;4CAC5C;4CACA,OAAO;wCACX;;oCAEA,sEAAsE;oCACtE,IAAI,kBAAkB,OAAO,aAAa,OAAO,iBAAiB;wCAC9D,cAAc;wCACd,MAAM,KAAK,OAAO,IAAI,UAAU,IAAI,WAAW;wCAE/C,qFAAqF;wCACrF,wCAAwC;wCACxC,MAAM,aAAa;4CACf;4CACA;4CACA;4CACA;4CACA;4CACA;4CACA;4CACA;4CACA;yCACH,CAAC,QAAQ,CAAC;wCAEX,SAAS;4CACL,MAAM;4CACN,OAAO,aAAa,iBAAiB;4CACrC,QAAQ,MAAM;4CACd,SAAS,GAAG,IAAI,QAAQ,GAAG,CAAC,EAAE,IAAI,UAAU,GAAG,OAAO,EAAE,IAAI,YAAY,KAAK,CAAC,IAAI;wCACtF;wCAEA,IAAI,YAAY;4CACZ,kBAAkB;4CAClB,kBAAkB;wCACtB;oCACJ;gCACJ;gCAEA,6EAA6E;gCAC7E,iCAAiC;gCACjC,gDAAgD;gCAChD,0CAA0C;gCAC1C,IAAI,YAAY,yBAAyB;oCACrC,MAAM,QAAQ,MAAM,OAAO,CAAC,OAAO,YAC7B,MAAM,QAAQ,GACd,MAAM,OAAO,CAAC,OAAO,SACjB,MAAM,KAAK,GACX,MAAM,OAAO,CAAC,OAAO,QACjB,MAAM,IAAI,GACV,EAAE;oCAEhB,IAAI,MAAM,MAAM,EAAE;wCACd,YACI,MACK,GAAG;2EAAC,CAAC,IAAM,CAAC;oDACT,OAAO,OAAO,EAAE,KAAK,IAAI,IAAI,WAAW;oDACxC,MAAM,OAAO,EAAE,IAAI,IAAI;oDACvB,QAAQ,OAAO,EAAE,MAAM,IAAI;gDAC/B,CAAC;0EACA,MAAM;2EAAC,CAAC,IAAM,EAAE,KAAK;;wCAE9B,qBAAqB,KAAK,GAAG;wCAC7B,iBAAiB;oCACrB;oCACA;gCACJ;gCAEA,IAAI,YAAY,uBAAuB;oCACnC,MAAM,MAAM,OAAO,OAAO,UAAU,IAAI,WAAW;oCACnD,MAAM,MAAM,OAAO,OAAO,YAAY;oCACtC,IAAI,CAAC,OAAO,QAAQ,OAAO,kBAAkB,OAAO,EAAE,WAAW,IAAI;oCACrE,IAAI,OAAO,QAAQ,iBAAiB,OAAO,EAAE;oCAE7C,MAAM,SAAS,gBAAgB,OAAO;oCACtC,IAAI,CAAC,QAAQ;oCAEb,IAAI,OAAO,SAAS,oBAAoB,MAAM,OAAO,CAAC,OAAO,YAAY,OAAO,WAAW,kBAAkB,OAAO,EAAE;wCAClH,MAAM,OAAO,MAAM,OAAO,CACrB,GAAG;gFAAC,CAAA,IAAK,CAAC;oDACP,MAAM,OAAO,EAAE,IAAI;oDACnB,MAAM,OAAO,EAAE,IAAI;oDACnB,MAAM,OAAO,EAAE,IAAI;oDACnB,KAAK,OAAO,EAAE,GAAG;oDACjB,OAAO,OAAO,EAAE,KAAK;gDACzB,CAAC;+EACA,MAAM;gFAAC,CAAA,IACJ,OAAO,QAAQ,CAAC,EAAE,IAAI,KACtB,OAAO,QAAQ,CAAC,EAAE,IAAI,KACtB,OAAO,QAAQ,CAAC,EAAE,IAAI,KACtB,OAAO,QAAQ,CAAC,EAAE,GAAG,KACrB,OAAO,QAAQ,CAAC,EAAE,KAAK;+EAE1B,IAAI;gFAAC,CAAC,GAAG,IAAM,EAAE,IAAI,GAAG,EAAE,IAAI;;wCAEnC,OAAO,OAAO,CAAC;wCAEf,MAAM,QAAQ,YAAY,OAAO;wCACjC,IAAI,OAAO;4CACP,MAAM,SAAS,GAAG,gBAAgB;4CAClC,MAAM,SAAS,GAAG,sBAAsB,CAAC;gDAAE,MAAM;gDAAG,IAAI;4CAAG;wCAC/D;wCAGA;oCACJ;oCAEA,IAAI,OAAO,SAAS,kBAAkB,OAAO,WAAW,kBAAkB,OAAO,EAAE;wCAC/E,MAAM,IAAI,OAAO,SAAS,OAAO,KAAK,OAAO;wCAC7C,IAAI,CAAC,GAAG;wCAER,MAAM,MAAM;4CACR,MAAM,KAAK,KAAK,CAAC,OAAO,EAAE,SAAS,IAAI,EAAE,IAAI,IAAI;4CACjD,MAAM,OAAO,EAAE,IAAI;4CACnB,MAAM,OAAO,EAAE,IAAI;4CACnB,KAAK,OAAO,EAAE,GAAG;4CACjB,OAAO,OAAO,EAAE,KAAK;wCACzB;wCAEA,IACI,CAAC,OAAO,QAAQ,CAAC,IAAI,IAAI,KACzB,CAAC,OAAO,QAAQ,CAAC,IAAI,IAAI,KACzB,CAAC,OAAO,QAAQ,CAAC,IAAI,IAAI,KACzB,CAAC,OAAO,QAAQ,CAAC,IAAI,GAAG,KACxB,CAAC,OAAO,QAAQ,CAAC,IAAI,KAAK,GAC5B;wCAEF,OAAO,MAAM,CAAC;wCACd;oCACJ;gCACJ;4BACJ,EAAE,OAAM;4BACJ,sBAAsB;4BAC1B;wBACJ;;gBACJ;;YAEA,MAAM;yDAAoB;oBACtB,IAAI,WAAW;oBACf,IAAI,YAAY;oBAChB,WAAW;oBACX,MAAM,QAAQ,KAAK,GAAG,CAAC,MAAM,MAAM;oBACnC,aAAa;iEAAW;4BACpB,aAAa;4BACb;wBACJ;gEAAG;gBACP;;YAEA;YAEA;uCAAO;oBACH,YAAY;oBACZ,IAAI,YAAY,aAAa;oBAC7B,IAAI;wBACA,IAAI;oBACR,EAAE,OAAM,CAAE;gBACd;;QACJ;8BAAG;QAAC;QAAW;QAAa;KAAe;IAE3C,IAAA,8LAAS;+BAAC;YACN,IAAI;gBACA,MAAM,MAAM,aAAa,OAAO,CAAC;gBACjC,IAAI,CAAC,KAAK;gBACV,MAAM,MAAM,KAAK,KAAK,CAAC;gBACvB,IAAI,MAAM,OAAO,CAAC,MAAM,UAAU,IAAI,IAAI,IAAI,GAAG;2CAAC,CAAC,IAAM,OAAO,GAAG,WAAW;;YAClF,EAAE,OAAM,CAAE;QACd;8BAAG,EAAE;IAEL,IAAA,8LAAS;+BAAC;YACN,IAAI;gBACA,aAAa,OAAO,CAAC,iBAAiB,KAAK,SAAS,CAAC,MAAM,IAAI,CAAC;YACpE,EAAE,OAAM,CAAE;QACd;8BAAG;QAAC;KAAO;IAGX,IAAA,8LAAS;+BAAC;YACN,IAAI;gBACA,aAAa,OAAO,CAAC,SAAS;YAClC,EAAE,OAAM,CAAE;YAEV,SAAS,eAAe,CAAC,KAAK,CAAC,WAAW,GAAG;YAC7C,IAAI,UAAU,QAAQ,SAAS,eAAe,CAAC,SAAS,CAAC,GAAG,CAAC;iBACxD,SAAS,eAAe,CAAC,SAAS,CAAC,MAAM,CAAC;QACnD;8BAAG;QAAC;KAAM;IAEV,IAAA,8LAAS;+BAAC;YACN,kDAAkD;YAClD,MAAM,WAAW;gDAAY;oBACzB,eAAe;wBAAE,GAAG,eAAe,OAAO;oBAAC;oBAC3C,gBAAgB,YAAY,OAAO;gBACvC;+CAAG;YACH;uCAAO,IAAM,cAAc;;QAC/B;8BAAG,EAAE;IAEL,IAAA,8LAAS;+BAAC;YACN,IAAI,cAAc,UAAU;gBACxB,gBAAgB;gBAChB;YACJ;YACA,IAAI,cAAc,aAAa;gBAC3B,mBAAmB;gBACnB;YACJ;QACA,uDAAuD;QAC3D;8BAAG;QAAC;QAAW;QAAc;KAAgB;IAC7C,eAAe,mBAAmB,SAAS,IAAI;QAC3C,MAAM,QAAQ,IAAA,qJAAQ;QACtB,IAAI,CAAC,OAAO;YACR,OAAO,IAAI,CAAC;YACZ;QACJ;QAEA,oBAAoB;QACpB,kBAAkB;QAElB,IAAI;YACA,MAAM,KAAK,IAAI;YACf,GAAG,GAAG,CAAC,SAAS,OAAO;YACvB,IAAI,QAAQ,GAAG,GAAG,CAAC,UAAU,OAAO;YAEpC,MAAM,MAAM,MAAM,MAAM,GAAG,WAAW,WAAW,EAAE,GAAG,QAAQ,IAAI,EAAE;gBAChE,QAAQ;gBACR,SAAS;oBACL,gBAAgB;oBAChB,eAAe,CAAC,OAAO,EAAE,OAAO;gBACpC;gBACA,OAAO;YACX;YAEA,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YAC7C,IAAI,CAAC,IAAI,EAAE,IAAI,MAAM,OAAO,OAAO;gBAC/B,MAAM,IAAI,MAAM,MAAM,SAAS,CAAC,2BAA2B,EAAE,IAAI,MAAM,CAAC,CAAC,CAAC;YAC9E;YAEA,MAAM,QAAQ,MAAM,OAAO,CAAC,MAAM,SAC5B,KAAK,KAAK,GACV,MAAM,OAAO,CAAC,MAAM,QAChB,KAAK,IAAI,GACT,EAAE;YAEZ,iBAAiB;YAEjB,MAAM,KACF,MAAM,cACN,CAAC,MAAM,MAAM,GAAG,KAAK,CAAC,MAAM,MAAM,GAAG,EAAE,EAAE,MAAM,OAAO,IAAI;YAE9D,uBAAuB,MAAM;YAE7B,MAAM,KAAK,OAAO,MAAM;YACxB,MAAM,KAAK,OAAO,MAAM;YACxB,IAAI,OAAO,QAAQ,CAAC,KAAK,yBAAyB;YAClD,IAAI,OAAO,QAAQ,CAAC,OAAO,KAAK,GAAG,uBAAuB;QAC9D,EAAE,OAAO,GAAG;YACR,kBAAkB,GAAG,WAAW;YAChC,iBAAiB,EAAE;YACnB,uBAAuB;YACvB,yBAAyB;YACzB,uBAAuB;QAC3B,SAAU;YACN,oBAAoB;QACxB;IACJ;IAEA,SAAS,UAAU,GAAG;QAClB,MAAM,IAAI,OAAO,KAAK,WAAW;QACjC,UAAU,CAAC;YACP,MAAM,OAAO,IAAI,IAAI;YACrB,IAAI,KAAK,GAAG,CAAC,IAAI,KAAK,MAAM,CAAC;iBACxB,KAAK,GAAG,CAAC;YACd,OAAO;QACX;IACJ;IAEA,eAAe,YAAY,EAAE;QACzB,IAAI;YACA,MAAM,UAAU,SAAS,CAAC,SAAS,CAAC,OAAO;YAC3C,UAAU;YACV,WAAW,IAAM,UAAU,KAAK;QACpC,EAAE,OAAM;YACJ,UAAU;YACV,WAAW,IAAM,UAAU,KAAK;QACpC;IACJ;IAEA,SAAS;QACL,SAAS,CAAC,IAAO,MAAM,SAAS,UAAU;IAC9C;IAEA,SAAS,YAAY,CAAC;QAClB,IAAI,CAAC,OAAO,QAAQ,CAAC,OAAO,KAAK,OAAO;QACxC,OAAO,OAAO,GAAG,OAAO,CAAC,GAAG,OAAO,CAAC,UAAU;IAClD;IAEA,SAAS,SAAS,CAAC;QACf,MAAM,IAAI,OAAO;QACjB,OAAO,OAAO,QAAQ,CAAC,KAAK,IAAI;IACpC;IAEA,SAAS,iBAAiB,IAAI;QAC1B,MAAM,IAAI,OAAO;QACjB,MAAM,IAAI,EAAE,OAAO,CAAC;QACpB,OAAO,MAAM,CAAC,IAAI,IAAI,EAAE,MAAM,GAAG,IAAI;IACzC;IAEA,SAAS,YAAY,KAAK,EAAE,IAAI;QAC5B,MAAM,IAAI,SAAS;QACnB,MAAM,KAAK,SAAS;QACpB,IAAI,MAAM,QAAQ,OAAO,QAAQ,MAAM,GAAG,OAAO;QAEjD,MAAM,IAAI,iBAAiB;QAC3B,MAAM,QAAQ,KAAK,GAAG,CAAC,IAAI;QAE3B,gFAAgF;QAChF,MAAM,UAAU,KAAK,KAAK,CAAC,KAAK;QAChC,IAAI,CAAC,OAAO,QAAQ,CAAC,YAAY,WAAW,GAAG,OAAO;QAEtD,6BAA6B;QAC7B,MAAM,OAAO,KAAK,KAAK,CAAC,IAAI,QAAQ,OAAO,sCAAsC;QACjF,MAAM,aAAa,KAAK,KAAK,CAAC,OAAO,WAAW;QAChD,MAAM,MAAM,aAAa;QAEzB,OAAO,OAAO,IAAI,OAAO,CAAC;IAC9B;IAEA,SAAS,UAAU,CAAC;QAChB,OAAO,OAAO,GAAG,OAAO,CAAC,UAAU;IACvC;IAEA,SAAS,aAAa,KAAK,EAAE,IAAI;QAC7B,MAAM,IAAI,SAAS;QACnB,MAAM,KAAK,SAAS;QACpB,IAAI,MAAM,MAAM,OAAO;QACvB,IAAI,OAAO,QAAQ,MAAM,GAAG,OAAO,UAAU;QAE7C,MAAM,IAAI,KAAK,GAAG,CAAC,iBAAiB,OAAO,IAAI,aAAa;QAC5D,OAAO,UAAU,OAAO,GAAG,OAAO,CAAC;IACvC;IAEA,SAAS,iBAAiB,EAAE,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,gBAAgB,EAAE;QACnE,IAAI,CAAC,MAAM,OAAO;YAAE,IAAI;QAAK;QAE7B,MAAM,OAAO,SAAS,KAAK,WAAW;QACtC,MAAM,OAAO,SAAS,KAAK,WAAW;QAEtC,MAAM,mBAAmB,QAAQ,KAAK,gBAAgB;QACtD,MAAM,mBAAmB,QAAQ,KAAK,gBAAgB;QAEtD,MAAM,iBAAiB,cAAc,YAAY;QACjD,MAAM,iBAAiB,cAAc,YAAY;QAEjD,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,OAAO;YAAE,IAAI;QAAK;QAE1D,MAAM,IAAI,SAAS;QACnB,IAAI,MAAM,QAAQ,KAAK,GAAG,OAAO;YAAE,IAAI;QAAK,GAAG,+BAA+B;QAE9E,MAAM,WAAW,IAAI;QAErB,IAAI,kBAAkB,SAAS,QAAQ,WAAW,MAAM;YACpD,OAAO;gBAAE,IAAI;gBAAO,QAAQ,CAAC,oBAAoB,EAAE,UAAU,UAAU,OAAO,EAAE,UAAU,MAAM,KAAK,CAAC;YAAC;QAC3G;QACA,IAAI,kBAAkB,SAAS,QAAQ,WAAW,MAAM;YACpD,OAAO;gBAAE,IAAI;gBAAO,QAAQ,CAAC,oBAAoB,EAAE,UAAU,UAAU,OAAO,EAAE,UAAU,MAAM,KAAK,CAAC;YAAC;QAC3G;QACA,OAAO;YAAE,IAAI;QAAK;IACtB;IAEA,SAAS,YAAY,CAAC,EAAE,IAAI;QACxB,MAAM,KAAK,SAAS;QACpB,IAAI,OAAO,QAAQ,MAAM,GAAG,OAAO;YAAE,IAAI;YAAO,QAAQ;QAAyB;QACjF,IAAI,CAAC,MAAM,OAAO;YAAE,IAAI;QAAK;QAE7B,MAAM,SAAS,SAAS,KAAK,MAAM;QACnC,IAAI,WAAW,QAAQ,KAAK,QAAQ;YAChC,OAAO;gBAAE,IAAI;gBAAO,QAAQ,CAAC,WAAW,EAAE,KAAK,MAAM,EAAE;YAAC;QAC5D;QAEA,MAAM,OAAO,SAAS,KAAK,QAAQ;QACnC,IAAI,SAAS,QAAQ,QAAQ,GAAG,OAAO;YAAE,IAAI;QAAK;QAElD,MAAM,IAAI,iBAAiB,KAAK,QAAQ;QACxC,MAAM,QAAQ,KAAK,GAAG,CAAC,IAAI;QAE3B,MAAM,UAAU,KAAK,KAAK,CAAC,OAAO;QAClC,IAAI,CAAC,OAAO,QAAQ,CAAC,YAAY,WAAW,GAAG,OAAO;YAAE,IAAI;QAAK;QAEjE,oEAAoE;QACpE,MAAM,SAAS,KAAK,KAAK,CAAC,KAAK;QAC/B,IAAI,SAAS,YAAY,GAAG;YACxB,OAAO;gBAAE,IAAI;gBAAO,QAAQ,CAAC,0BAA0B,EAAE,KAAK,QAAQ,EAAE;YAAC;QAC7E;QAEA,OAAO;YAAE,IAAI;QAAK;IACtB;IAEA,2BAA2B;IAC3B,SAAS,YAAY,GAAG;QACpB,wDAAwD;QACxD,MAAM,MAAM,CAAC;QACb,KAAK,MAAM,SAAS,IAAI,MAAM,IAAI,EAAE,CAAE;YAClC,MAAM,MAAM,CAAC,MAAM,IAAI,IAAI,MAAM,IAAI,CAAC,MAAM,GAAG,MAAM,IAAI,CAAC,EAAE,GAAG,MAAM,KAAK;YAC1E,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,GAAG,CAAC,IAAI,GAAG,MAAM,OAAO;QAC3C;QACA,OAAO;IACX;IAEA,+CAA+C;IAC/C,SAAS,iBAAiB,EAAE,IAAI,EAAE,SAAS,EAAE,YAAY,EAAE;QACvD,gEAAgE;QAChE,OAAO,yMAAC,CACH,MAAM,CAAC;YACJ,KAAK,yMAAC,CACD,MAAM,GACN,IAAI,GACJ,GAAG,CAAC,GAAG;YACZ,YAAY,yMAAC,CAAC,MAAM,GAAG,IAAI,GAAG,QAAQ;YACtC,WAAW,yMAAC,CAAC,MAAM,GAAG,IAAI,GAAG,QAAQ;QACzC,GACC,WAAW,CAAC,CAAC,KAAK;YACf,WAAW;YACX,MAAM,SAAS,YAAY,IAAI,GAAG,EAAE;YACpC,IAAI,CAAC,OAAO,EAAE,EAAE;gBACZ,IAAI,QAAQ,CAAC;oBAAE,MAAM,yMAAC,CAAC,YAAY,CAAC,MAAM;oBAAE,MAAM;wBAAC;qBAAM;oBAAE,SAAS,OAAO,MAAM;gBAAC;gBAClF;YACJ;YAEA,MAAM,SAAS,OAAO,IAAI,GAAG;YAE7B,uCAAuC;YACvC,IAAI,mBAAmB;YAEvB,IAAI,cAAc,SAAS;gBACvB,MAAM,IAAI,OAAO,IAAI,UAAU;gBAC/B,IAAI,CAAC,OAAO,QAAQ,CAAC,MAAM,KAAK,GAAG;oBAC/B,IAAI,QAAQ,CAAC;wBAAE,MAAM,yMAAC,CAAC,YAAY,CAAC,MAAM;wBAAE,MAAM;4BAAC;yBAAa;wBAAE,SAAS;oBAA4B;oBACvG;gBACJ;gBACA,mBAAmB;YACvB;YAEA,IAAI,cAAc,aAAa;gBAC3B,MAAM,KAAK,OAAO,IAAI,SAAS;gBAC/B,IAAI,CAAC,OAAO,QAAQ,CAAC,OAAO,MAAM,GAAG;oBACjC,IAAI,QAAQ,CAAC;wBAAE,MAAM,yMAAC,CAAC,YAAY,CAAC,MAAM;wBAAE,MAAM;4BAAC;yBAAY;wBAAE,SAAS;oBAA2B;oBACrG;gBACJ;gBACA,mBAAmB;YACvB;YAEA,gDAAgD;YAChD,MAAM,SAAS,iBAAiB;gBAAE;gBAAQ;gBAAM;gBAAW;YAAiB;YAC5E,IAAI,CAAC,OAAO,EAAE,EAAE;gBACZ,4DAA4D;gBAC5D,IAAI,QAAQ,CAAC;oBAAE,MAAM,yMAAC,CAAC,YAAY,CAAC,MAAM;oBAAE,MAAM;wBAAC;qBAAW;oBAAE,SAAS,OAAO,MAAM;gBAAC;gBACvF;YACJ;QACJ;IACR;IAEA,eAAe,gBAAgB,SAAS,IAAI;QACxC,MAAM,QAAQ,IAAA,qJAAQ;QACtB,IAAI,CAAC,OAAO;YACR,OAAO,IAAI,CAAC;YACZ;QACJ;QAEA,iBAAiB;QACjB,eAAe;QAEf,IAAI;YACA,MAAM,KAAK,IAAI;YACf,GAAG,GAAG,CAAC,SAAS,OAAO;YACvB,IAAI,QAAQ,GAAG,GAAG,CAAC,UAAU,OAAO,UAAU,iBAAiB;YAE/D,MAAM,MAAM,MAAM,MAAM,GAAG,WAAW,QAAQ,EAAE,GAAG,QAAQ,IAAI,EAAE;gBAC7D,QAAQ;gBACR,SAAS;oBACL,gBAAgB;oBAChB,eAAe,CAAC,OAAO,EAAE,OAAO;gBACpC;gBACA,OAAO;YACX;YAEA,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YAC7C,IAAI,CAAC,IAAI,EAAE,IAAI,MAAM,OAAO,OAAO;gBAC/B,MAAM,IAAI,MAAM,MAAM,SAAS,CAAC,wBAAwB,EAAE,IAAI,MAAM,CAAC,CAAC,CAAC;YAC3E;YAEA,wDAAwD;YACxD,MAAM,QAAQ,MAAM,OAAO,CAAC,MAAM,SAC5B,KAAK,KAAK,GACV,MAAM,OAAO,CAAC,MAAM,QAChB,KAAK,IAAI,GACT,EAAE;YAEZ,cAAc;YAEd,MAAM,KACF,MAAM,cACN,CAAC,MAAM,MAAM,GAAG,KAAK,CAAC,MAAM,MAAM,GAAG,EAAE,EAAE,WAAW,OAAO,IAAI;YAEnE,oBAAoB,MAAM;YAE1B,MAAM,KAAK,OAAO,MAAM;YACxB,MAAM,KAAK,OAAO,MAAM;YACxB,IAAI,OAAO,QAAQ,CAAC,KAAK,sBAAsB;YAC/C,IAAI,OAAO,QAAQ,CAAC,OAAO,KAAK,GAAG,oBAAoB;QAC3D,EAAE,OAAO,GAAG;YACR,eAAe,GAAG,WAAW;YAC7B,cAAc,EAAE;YAChB,oBAAoB;YACpB,sBAAsB;YACtB,oBAAoB;QACxB,SAAU;YACN,iBAAiB;QACrB;IACJ;IAEA,eAAe;QACX,MAAM,QAAQ,IAAA,qJAAQ;QACtB,IAAI,CAAC,OAAO;YACR,OAAO,IAAI,CAAC;YACZ;QACJ;QAEA,mBAAmB;QACnB,iBAAiB;QAEjB,IAAI;YACA,2DAA2D;YAC3D,MAAM,MAAM,MAAM,MAAM,GAAG,WAAW,oBAAoB,CAAC,EAAE;gBACzD,QAAQ;gBACR,SAAS;oBACL,gBAAgB;oBAChB,eAAe,CAAC,OAAO,EAAE,OAAO;gBACpC;gBACA,OAAO;YACX;YAEA,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YAC7C,IAAI,CAAC,IAAI,EAAE,IAAI,MAAM,OAAO,OAAO;gBAC/B,MAAM,IAAI,MAAM,MAAM,SAAS,CAAC,0BAA0B,EAAE,IAAI,MAAM,CAAC,CAAC,CAAC;YAC7E;YAEA,MAAM,MAAM,MAAM,OAAO,CAAC,MAAM,YAC1B,KAAK,QAAQ,GACb,MAAM,OAAO,CAAC,MAAM,SAAS,YACzB,KAAK,OAAO,CAAC,QAAQ,GACrB,EAAE;YAEZ,MAAM,UAAU,IACX,GAAG,CAAC,CAAC,IAAM,CAAC;oBACT,OAAO,OAAO,EAAE,KAAK,IAAI,IAAI,WAAW;oBACxC,MAAM,OAAO,EAAE,IAAI,IAAI;oBACvB,QAAQ,OAAO,EAAE,MAAM,IAAI;gBAC/B,CAAC,GACA,MAAM,CAAC,CAAC,IAAM,EAAE,KAAK;YAE1B,YAAY;YACZ,qBAAqB,KAAK,GAAG;QACjC,EAAE,OAAO,GAAG;YACR,YAAY,EAAE;YACd,iBAAiB,GAAG,WAAW;QACnC,SAAU;YACN,mBAAmB;QACvB;IACJ;IAEA,eAAe,eAAe,MAAM,EAAE,QAAQ;QAC1C,IAAI;YACA,MAAM,MAAM,GAAG,aAAa,iBAAiB,CAAC,EAAE;gBAC5C,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBACjB,QAAQ,OAAO,UAAU,IAAI,WAAW;oBACxC,UAAU,OAAO,YAAY;gBACjC;YACJ;QACJ,EAAE,OAAM;QACJ,SAAS;QACb;IACJ;IAEA,MAAM,SAAS,UAAU;IAGzB,6DAA6D;IAC7D,IAAA,8LAAS;+BAAC;YACN,MAAM,KAAK,kBAAkB,OAAO;YACpC,IAAI,CAAC,IAAI;YAET,4DAA4D;YAC5D,IAAI;gBACA,GAAG,SAAS,GAAG;YACnB,EAAE,OAAM,CAAE;YAEV,qCAAqC;YACrC,IAAI;gBACA,YAAY,OAAO,EAAE;YACzB,EAAE,OAAM,CAAE;YACV,YAAY,OAAO,GAAG;YACtB,gBAAgB,OAAO,GAAG;YAE1B,MAAM,QAAQ,IAAA,wMAAW,EAAC,IAAI;gBAC1B,UAAU;gBACV,WAAW;oBAAE,MAAM,0MAAa,CAAC,MAAM;gBAAC;gBACxC,WAAW;oBAAE,aAAa;oBAAM,gBAAgB;gBAAM;gBACtD,QAAQ;oBACJ,YAAY;wBAAE,OAAO;oBAAU;oBAC/B,WAAW;gBACf;gBACA,MAAM;oBACF,WAAW;wBAAE,OAAO;oBAAU;oBAC9B,WAAW;wBAAE,OAAO;oBAAU;gBAClC;YACJ;YAEA,MAAM,SAAS,MAAM,SAAS,CAAC,8MAAiB,EAAE,CAAC;YACnD,YAAY,OAAO,GAAG;YACtB,gBAAgB,OAAO,GAAG;YAE1B;uCAAO;oBACH,IAAI;wBACA,MAAM,MAAM;oBAChB,EAAE,OAAM,CAAE;oBACV,YAAY,OAAO,GAAG;oBACtB,gBAAgB,OAAO,GAAG;gBAC9B;;QACJ;8BAAG,EAAE;IAEL,+DAA+D;IAC/D,IAAA,8LAAS;+BAAC;YACN,MAAM,QAAQ,YAAY,OAAO;YACjC,IAAI,CAAC,OAAO;YAEZ,MAAM,YAAY,CAAC;gBACf,QAAQ;oBACJ,YAAY;wBAAE,OAAO,SAAS,YAAY;oBAAU;oBACpD,WAAW,SAAS,YAAY;gBACpC;gBACA,MAAM;oBACF,WAAW;wBAAE,OAAO,SAAS,YAAY;oBAAU;oBACnD,WAAW;wBAAE,OAAO,SAAS,YAAY;oBAAU;gBACvD;YACJ;YAEA,kEAAkE;YAClE,MAAM,SAAS,gBAAgB,OAAO;YACtC,IAAI,QAAQ,cAAc;gBACtB,OAAO,YAAY,CAAC;oBAChB,aAAa;wBAAE,MAAM;wBAAS,WAAW;wBAAG,SAAS;oBAAS;gBAClE;YACJ;QACJ;8BAAG;QAAC;KAAO;IAEX,IAAA,8LAAS;+BAAC;YACN,IAAI,YAAY;YAEhB,eAAe;gBACX,oBAAoB;gBACpB,mBAAmB;gBAEnB,IAAI;oBACA,MAAM,MAAM,MAAM,MACd,GAAG,aAAa,oBAAoB,EAAE,gBAAgB;oBAE1D,MAAM,OAAO,MAAM,IAAI,IAAI;oBAE3B,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM,KAAK,KAAK,IAAI;oBAE3C,IAAI,CAAC,WAAW;wBACZ,cAAc,KAAK,IAAI;wBACvB,oBAAoB;wBAEpB,wBAAwB;wBACxB,MAAM,UAAU,YAAY,KAAK,KAAK,IAAI,CAAC,QAAQ;wBACnD,IAAI,YAAY,MAAM,OAAO,OAAO;oBACxC;gBACJ,EAAE,OAAO,KAAK;oBACV,IAAI,CAAC,WAAW;wBACZ,cAAc;wBACd,oBAAoB;wBACpB,mBAAmB,IAAI,OAAO;oBAClC;gBACJ;YACJ;YAEA;YACA;uCAAO,IAAO,YAAY;;QAC9B;8BAAG;QAAC;KAAe;IAEnB,IAAA,8LAAS;+BAAC;YACN,eAAe,gBAAgB;YAC/B,IAAI;gBACA,gBAAgB,OAAO,EAAE,QAAQ,EAAE;YACvC,EAAE,OAAM,CAAE;QACd;8BAAG;QAAC;QAAgB;KAAc;IAElC,eAAe;QACX,IAAI,CAAC,UAAU,OAAO,EAAE;YACpB,UAAU;YACV,OAAO,IAAI,CAAC;YACZ;QACJ;QACA,UAAU;QACV,cAAc,CAAC;QACf,IAAI,gBAAgB;QACpB,kBAAkB;QAElB,MAAM,SAAS,iBAAiB;YAAE,MAAM;YAAY;YAAW,cAAc,SAAS;QAAc;QACpG,MAAM,SAAS,OAAO,SAAS,CAAC;YAC5B;YACA;YACA;QACJ;QAEA,IAAI,CAAC,OAAO,OAAO,EAAE;YACjB,MAAM,MAAM,YAAY,OAAO,KAAK;YACpC,cAAc;YACd,qDAAqD;YACrD,UAAU,IAAI,QAAQ,IAAI,IAAI,GAAG,IAAI,IAAI,UAAU,IAAI,IAAI,SAAS,IAAI,IAAI,IAAI,IAAI;YACpF,kBAAkB;YAClB;QACJ;QAEA,IAAI,SAAS,OAAO,OAAO,IAAI,CAAC,GAAG;QACnC,IAAI,gBAAgB,cAAc,UAAU,OAAO,OAAO,IAAI,CAAC,UAAU,IAAI;QAC7E,IAAI,eAAe,cAAc,cAAc,OAAO,OAAO,IAAI,CAAC,SAAS,IAAI;QAE/E,uDAAuD;QACvD,IAAI,YAAY;YACZ,IAAI,WAAW,QAAQ,EAAE;gBACrB,MAAM,IAAI,YAAY,QAAQ,WAAW,QAAQ;gBACjD,IAAI,MAAM,MAAM,SAAS;YAC7B;YACA,IAAI,WAAW,QAAQ,EAAE;gBACrB,IAAI,kBAAkB,WAAW;oBAC7B,MAAM,IAAI,YAAY,eAAe,WAAW,QAAQ;oBACxD,IAAI,MAAM,MAAM,gBAAgB;gBACpC;gBACA,IAAI,iBAAiB,WAAW;oBAC5B,MAAM,IAAI,YAAY,cAAc,WAAW,QAAQ;oBACvD,IAAI,MAAM,MAAM,eAAe;gBACnC;YACJ;QACJ;QAEA,UAAU;QACV,MAAM,gBACF,OAAO,WAAW,eAAe,OAAO,UAAU,GAC5C,OAAO,UAAU,KACjB,CAAC,IAAI,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC,IAAI;QAEpE,kBAAkB;QAClB,SAAS;YACL,MAAM;YACN,OAAO;YACP,QAAQ;YACR,SAAS,GAAG,KAAK,CAAC,EAAE,eAAe,OAAO,EAAE,QAAQ;QACxD;QAEA,IAAI;YACA,MAAM,UAAU;gBACZ,SAAS;gBACT,QAAQ,UAAU,OAAO;gBACzB,QAAQ,OAAO,kBAAkB,IAAI,WAAW;gBAChD,MAAM,OAAO,QAAQ,IAAI,WAAW;gBACpC,WAAW,OAAO,aAAa,UAAU,WAAW;gBACpD,UAAU;gBACV,MAAM,CAAC;YACX;YAEA,wBAAwB;YACxB,uCAAuC;YACvC,6CAA6C;YAC7C,IAAI,cAAc,SAAS;gBACvB,QAAQ,KAAK,GAAG;gBAChB,QAAQ,WAAW,GAAG;YAC1B,OAAO,IAAI,cAAc,aAAa;gBAClC,QAAQ,SAAS,GAAG;YACxB;YAEA,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,OAAO,CAAC,EAAE;gBAC9C,QAAQ;gBACR,SAAS;oBACL,gBAAgB;gBACpB;gBACA,MAAM,KAAK,SAAS,CAAC;YACzB;YAEA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,QAAQ,GAAG,CAAC,yBAAyB;YACrC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,KAAK,EAAE,EAAE;gBACrB,kBAAkB;gBAClB,UAAU,KAAK,KAAK,IAAI;gBACxB;YACJ;YAEA,UAAU;QACd,EAAE,OAAO,GAAG;YACR,kBAAkB;YAClB,UAAU;QACd;IACJ;IAEA,MAAM,IAAI,OAAO,IAAI,GAAG,WAAW;IAEnC,2DAA2D;IAC3D,MAAM,iBAAiB,eAAe,OAAO;IAE7C,MAAM,aAAa,MAAM,IAAI,CAAC;IAC9B,MAAM,YAAY;IAElB,MAAM,aAAa,WACd,GAAG,CAAC,CAAC,MAAQ;YAAC;YAAK,WAAW,CAAC,IAAI;SAAC,EACpC,MAAM,CAAC,CAAC,CAAC,KAAK,EAAE,GAAK,KAAK,CAAC,CAAC,KAAK,IAAI,WAAW,GAAG,QAAQ,CAAC,EAAE;IAEnE,MAAM,cAAc,eACf,MAAM,CAAC,CAAC,MAAQ,CAAC,UAAU,GAAG,CAAC,MAC/B,GAAG,CAAC,CAAC,MAAQ;YAAC;YAAK,WAAW,CAAC,IAAI;SAAC,EACpC,MAAM,CAAC,CAAC,CAAC,KAAK,EAAE,GAAK,KAAK,CAAC,CAAC,KAAK,IAAI,WAAW,GAAG,QAAQ,CAAC,EAAE;IAEnE,MAAM,OAAO;WAAI;WAAe;KAAY;IAC5C,MAAM,QAAQ,KAAK,KAAK,CAAC,GAAG;IAE5B,8BAA8B;IAC9B,MAAM,eAAe,eAAe,OAAO,CAAC,MAAM;IAElD,MAAM,eAAe,WAAW,CAAC,eAAe,EAAE;IAElD,MAAM,aACF,cAAc,WAAW,UAAU,cAAc,cAAc,eAAe;IAElF,MAAM,mBACF,cAAc,WACR,iBACA,cAAc,cACV,qBACA;IAEd,MAAM,aACF,cAAc,WACP,OAAO,QAAQ,CAAC,OAAO,iBAAiB,OAAO,gBAAgB,KAChE,cAAc,cACV,YACA;IAGd,qBACI,iNAAC;QAAK,WAAW,GAAG,uJAAK,CAAC,SAAS,CAAC,sEAAsE,EAAE,SAAS,kCAAkC,iCAAiC;;0BAEpL,iNAAC;gBAAI,WAAW,CAAC,4CAA4C,EAAE,SAAS,oCAAoC,8BAA8B;0BACtI,cAAA,iNAAC;oBAAI,WAAU;;sCACX,iNAAC;4BAAI,WAAU;sCACX,cAAA,iNAAC;gCAAI,WAAU;0CACX,cAAA,iNAAC,+JAAK;oCAAC,KAAI;oCAAY,KAAI;oCAAO,WAAU;oCAAoB,OAAO;oCAAK,QAAQ;;;;;;;;;;;;;;;;sCAI5F,iNAAC;4BAAI,WAAU;;8CAEX,iNAAC;oCAAI,WAAW,CAAC,sFAAsF,EAAE,SAAS,sDAAsD,4CAA4C;;sDAChN,iNAAC;4CAAK,WAAU;;8DACZ,iNAAC;oDAAK,WAAU;;;;;;8DAChB,iNAAC;oDAAK,WAAU;;;;;;;;;;;;wCACb;;;;;;;8CAIX,iNAAC;oCAAI,WAAU;8CACX,cAAA,iNAAC;wCACG,SAAS;wCACT,WAAW,CAAC,0DAA0D,EAAE,SAAS,wCAAwC,oDAAoD;kDAE5K,uBAAS,iNAAC,+JAAU;;;;iEAAM,iNAAC,uKAAkB;;;;;;;;;;;;;;;8CAQtD,iNAAC;oCAAI,WAAU;;sDACX,iNAAC;4CACG,SAAS,IAAM,iBAAiB,CAAC;4CACjC,WAAW,CAAC,yFAAyF,EAAE,gBAChG,SAAS,8CAA8C,8CACvD,SAAS,yEAAyE,gEACnF;sDAEN,cAAA,iNAAC,8JAAS;gDAAC,WAAU;;;;;;;;;;;wCAIxB,+BACG,iNAAC;4CACG,WAAW,CAAC,uHAAuH,EAAE,SAC/H,kEACA,qEACA;;8DAEN,iNAAC;oDAAI,WAAU;;sEAEX,iNAAC;4DAAI,WAAW,CAAC,yDAAyD,EAAE,SAAS,qBAAqB,oBAAoB;sEAAE;;;;;;sEAKhI,iNAAC;4DACG,WAAW,CAAC,0FAA0F,EAAE,SAAS,sCAAsC,yCACjJ;4DACN,SAAS;gEAAQ,MAAM;4DAAiB;;8EAIxC,iNAAC;oEAAI,WAAU;oEAAqB,MAAK;oEAAO,QAAO;oEAAe,SAAQ;8EAAY,cAAA,iNAAC;wEAAK,eAAc;wEAAQ,gBAAe;wEAAQ,aAAa;wEAAG,GAAE;;;;;;;;;;;gEAAiI;;;;;;;sEAKpS,iNAAC;4DAAI,WAAW,CAAC,UAAU,EAAE,SAAS,eAAe,cAAc;;;;;;sEAGnE,iNAAC;4DACG,WAAU;4DACV,SAAS;gEACL,OAAO,IAAI,CAAC;4DAChB;;8EAGA,iNAAC;oEAAI,WAAU;oEAAU,MAAK;oEAAO,QAAO;oEAAe,SAAQ;8EAAY,cAAA,iNAAC;wEAAK,eAAc;wEAAQ,gBAAe;wEAAQ,aAAa;wEAAG,GAAE;;;;;;;;;;;gEAAoG;;;;;;;;;;;;;8DAMhQ,iNAAC;oDAAI,WAAW,CAAC,eAAe,EAAE,SAAS,8BAA8B,mCAAmC;8DACxG,cAAA,iNAAC;wDACG,SAAS,IAAM,iBAAiB;wDAChC,WAAW,CAAC,6GAA6G,EAAE,SAAS,uDAAuD,sDACrL;kEACT;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAW7B,iNAAC;gBAAI,WAAU;;kCACX,iNAAC;wBAAG,WAAU;kCAA+C;;;;;;kCAE7D,iNAAC;wBAAI,WAAU;;0CAEX,iNAAC;gCAAI,WAAU;;kDAGX,iNAAC;wCAAI,WAAW,CAAC,4CAA4C,EAAE,SAAS,8BAA8B,2BAA2B;kDAC7H,cAAA,iNAAC;4CAAI,WAAU;;8DAEX,iNAAC;oDAAI,WAAW,CAAC,2CAA2C,EAAE,SAAS,mBAAmB,kBAAkB;;sEACxG,iNAAC;4DACG,SAAS,IAAM,QAAQ;4DACvB,WAAW,CAAC,qDAAqD,EAAE,SAAS,QACrE,SAAS,8DAA8D,wCACxE,2CAA2C;sEACpD;;;;;;sEAGD,iNAAC;4DACG,SAAS;gEACL,QAAQ;gEACR,IAAI,cAAc,aAAa,aAAa;4DAChD;4DACA,WAAW,CAAC,qDAAqD,EAAE,SAAS,SACrE,SAAS,2DAA2D,qCACrE,2CAA2C;sEACpD;;;;;;;;;;;;8DAML,iNAAC;oDAAI,WAAU;8DACV;wDAAC;wDAAS;wDAAU;qDAAY,CAAC,GAAG,CAAC,CAAC;wDACnC,IAAI,SAAS,UAAU,MAAM,aAAa,OAAO;wDACjD,MAAM,WAAW,cAAc;wDAC/B,qBACI,iNAAC;4DAEG,SAAS;gEACL,aAAa;gEACb,IAAI,MAAM,SAAS,cAAc;gEACjC,IAAI,MAAM,aAAa,aAAa;4DACxC;4DACA,WAAW,CAAC,gFAAgF,EAAE,WACvF,SAAS,4BAA4B,4BACtC,8DAA8D;sEAEnE,MAAM,cAAc,gBAAgB,CAAC,CAAC,EAAE,GAAG,EAAE,KAAK,CAAC,GAAG,WAAW;2DAV7D;;;;;oDAajB;;;;;;8DAIJ,iNAAC;oDAAI,WAAU;;sEACX,iNAAC;;8EACG,iNAAC;oEAAI,WAAU;8EACX,cAAA,iNAAC;kFAAM;;;;;;;;;;;8EAEX,iNAAC;oEAAI,WAAW,CAAC,+DAA+D,EAAE,SAAS,8DAA8D,oEAAoE;;sFACzN,iNAAC;4EACG,WAAU;4EACV,aAAa;4EACb,UAAU,cAAc;4EACxB,OAAO;4EACP,UAAU,CAAC;gFACP,MAAM,IAAI,EAAE,MAAM,CAAC,KAAK;gFACxB,IAAI,cAAc,aAAa;oFAC3B,aAAa;oFACb,cAAc,CAAC,OAAS,CAAC;4FAAE,GAAG,IAAI;4FAAE,WAAW;4FAAW,UAAU;wFAAU,CAAC;gFACnF,OAAO,IAAI,cAAc,SAAS;oFAC9B,cAAc;oFACd,cAAc,CAAC,OAAS,CAAC;4FAAE,GAAG,IAAI;4FAAE,YAAY;4FAAW,UAAU;wFAAU,CAAC;gFACpF;4EACJ;;;;;;sFAEJ,iNAAC;4EAAK,WAAU;sFAAuC;;;;;;;;;;;;gEAG1D,cAAc,0BAAY,iNAAC;oEAAI,WAAU;8EAAkC;;;;;;gEAC3E,CAAC,WAAW,UAAU,IAAI,WAAW,SAAS,IAAI,WAAW,QAAQ,mBAClE,iNAAC;oEAAI,WAAU;8EAA4C,WAAW,UAAU,IAAI,WAAW,SAAS,IAAI,WAAW,QAAQ;;;;;;;;;;;;sEAIvI,iNAAC;4DAAI,WAAU;;8EACX,iNAAC;;sFACG,iNAAC;4EAAI,WAAU;sFAAkC;;;;;;sFACjD,iNAAC;4EAAI,WAAW,CAAC,+DAA+D,EAAE,SAAS,8DAA8D,oEAAoE;;8FACzN,iNAAC;oFACG,WAAU;oFACV,OAAO;oFACP,UAAU,CAAC;wFACP,OAAO,EAAE,MAAM,CAAC,KAAK;wFACrB,cAAc,CAAC,OAAS,CAAC;gGAAE,GAAG,IAAI;gGAAE,KAAK;gGAAW,UAAU;4FAAU,CAAC;oFAC7E;oFACA,aAAY;;;;;;8FAEhB,iNAAC;oFAAK,WAAU;8FAAwC,eAAe,OAAO,CAAC,QAAQ;;;;;;;;;;;;wEAE1F,WAAW,GAAG,kBAAI,iNAAC;4EAAI,WAAU;sFAA4C,WAAW,GAAG;;;;;;;;;;;;8EAEhG,iNAAC;;sFACG,iNAAC;4EAAI,WAAU;sFAAkC;;;;;;sFACjD,iNAAC;4EAAI,WAAW,CAAC,gDAAgD,EAAE,SAAS,iDAAiD,sDAAsD;;8FAC/K,iNAAC;oFACG,WAAU;oFACV,aAAY;oFACZ,QAAQ;oFACR,OAAO,GAAG,YAAY,eAAe,OAAO,QAAQ,IAAI;oFACxD,QAAQ;;;;;;8FAEZ,iNAAC;oFAAK,WAAU;8FAAiC;;;;;;;;;;;;;;;;;;;;;;;;sEAK7D,iNAAC;4DAAI,WAAU;;8EACX,iNAAC;oEAAK,WAAU;8EAAmB;;;;;;8EACnC,iNAAC;oEAAK,WAAW,CAAC,sBAAsB,EAAE,SAAS,eAAe,cAAc;8EAAG,YAAY;;;;;;;;;;;;wDAGlG,qBAAqB,yBAClB,iNAAC;4DAAI,WAAU;sEAAoD;;;;;;sEAGvE,iNAAC;4DACG,SAAS;4DACT,UAAU;4DACV,WAAW,CAAC,wFAAwF,EAAE,SAChG,+FACA,6FACD,CAAC,EAAE,iBAAiB,kCAAkC,IAAI;sEAE9D,iBAAiB,gCACd;;oEACK,SAAS,QAAQ,QAAQ;oEAAO;oEAAE,eAAe,OAAO,CAAC,QAAQ;;;;;;;;;;;;;;;;;;;;;;;;;kDAS1F,iNAAC;wCAAI,WAAW,CAAC,gCAAgC,EAAE,SAAS,8BAA8B,2BAA2B;;0DACjH,iNAAC;gDAAI,WAAU;;kEACX,iNAAC;wDAAG,WAAU;kEAAuC;;;;;;kEACrD,iNAAC;wDACG,SAAS;wDACT,UAAU;wDACV,WAAW,CAAC,+EAA+E,EAAE,kBAAkB,iBAAiB,IAAI;wDACpI,OAAM;kEAEN,cAAA,iNAAC;4DAAI,WAAW,CAAC,YAAY,EAAE,SAAS,qBAAqB,oBAAoB;4DAAE,MAAK;4DAAO,QAAO;4DAAe,SAAQ;sEAAY,cAAA,iNAAC;gEAAK,eAAc;gEAAQ,gBAAe;gEAAQ,aAAa;gEAAG,GAAE;;;;;;;;;;;;;;;;;;;;;;4CAIrN,+BAAiB,iNAAC;gDAAI,WAAU;0DAA8B;;;;;;0DAE/D,iNAAC;gDAAI,WAAU;0DACV,CAAC;oDACE,MAAM,UAAU,IAAI,IAAI,SAAS,GAAG,CAAC,CAAC,IAAM;4DAAC,EAAE,KAAK;4DAAE;yDAAE;oDACxD,MAAM,OAAO,QAAQ,GAAG,CAAC;oDACzB,MAAM,WAAW,OAAO,OAAO,KAAK,IAAI,IAAI,KAAK;oDACjD,MAAM,cAAc,MAAM,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC,IAAM,OAAO,GAAG,WAAW,GAAG,OAAO,CAAC,SAAS,KAAK,MAAM,CAAC,CAAC,IAAM,KAAK,MAAM;oDACzH,MAAM,kBAAkB,MAAM,IAAI,CAAC,IAAI,IAAI,cAAc,KAAK,CAAC,GAAG;oDAElE,qBACI;;0EACI,iNAAC;gEAAI,WAAU;;kFACX,iNAAC;wEAAI,WAAU;;0FACX,iNAAC;gFAAI,WAAU;0FAAiH;;;;;;0FAChI,iNAAC;gFAAK,WAAU;0FAAc;;;;;;;;;;;;kFAElC,iNAAC;wEAAI,WAAU;kFACX,cAAA,iNAAC;4EAAI,WAAU;sFAAyB,UAAU,SAAS,OAAO,CAAC;;;;;;;;;;;;;;;;;4DAI1E,gBAAgB,MAAM,GAAG,mBACtB,iNAAC;gEAAI,WAAU;0EACV,gBAAgB,GAAG,CAAC,CAAC;oEAClB,MAAM,IAAI,QAAQ,GAAG,CAAC;oEACtB,MAAM,OAAO,IAAI,OAAO,EAAE,IAAI,IAAI,KAAK;oEACvC,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC;oEAC1B,MAAM,OAAO,OAAO,WAAW,CAAC,IAAI,EAAE,SAAS;oEAC/C,MAAM,MAAM,OAAO,QAAQ,CAAC,SAAS,OAAO,IAAI,OAAO,OAAO;oEAE9D,IAAI,SAAS,GAAG,OAAO;oEAEvB,qBACI,iNAAC;wEAAgB,WAAU;;0FACvB,iNAAC;gFACG,SAAS,IAAM,kBAAkB;gFACjC,WAAU;0FAET;;;;;;0FAEL,iNAAC;gFAAI,WAAU;;kGACX,iNAAC;wFAAI,WAAU;kGAAqB,UAAU,KAAK,OAAO,CAAC;;;;;;kGAC3D,iNAAC;wFAAI,WAAU;kGACV,QAAQ,OAAO,CAAC,GAAG,EAAE,YAAY,MAAM,GAAG;;;;;;;;;;;;;uEAV7C;;;;;gEAelB;;;;;;4DAGP,mCAAqB,iNAAC;gEAAI,WAAU;;oEAA+C;oEAAS,IAAI,KAAK,mBAAmB,kBAAkB;;;;;;;;;gDAGvJ,CAAC;;;;;;;;;;;;;;;;;;0CAMb,iNAAC;gCAAI,WAAU;;kDAEX,iNAAC;wCAAI,WAAW,CAAC,0CAA0C,EAAE,SAAS,8BAA8B,2BAA2B;;0DAC3H,iNAAC;gDAAI,WAAU;;kEACX,iNAAC;wDAAI,WAAU;;0EACX,iNAAC;gEAAG,WAAU;;oEAAoC,eAAe,OAAO,CAAC,QAAQ;kFAAI,iNAAC;wEAAK,WAAU;kFAAuC;;;;;;;;;;;;0EAC5I,iNAAC;gEAAI,WAAU;;;;;;0EACf,iNAAC;gEAAI,WAAW,CAAC,6CAA6C,EAAE,SAAS,eAAe,oBAAoB;0EACvG,YAAY;;;;;;;;;;;;kEAIrB,iNAAC;wDAAI,WAAW,CAAC,uCAAuC,EAAE,SAAS,mCAAmC,oCAAoC;kEACrI;4DAAC;4DAAM;4DAAM;4DAAM;yDAAK,CAAC,GAAG,CAAC,CAAC,kBAC3B,iNAAC;gEAEG,SAAS,IAAM,iBAAiB;gEAChC,WAAW,CAAC,kDAAkD,EAAE,MAAM,gBAC/D,SAAS,8BAA8B,kCACxC,uEAAuE;0EAE5E;+DANI;;;;;;;;;;;;;;;;0DAYrB,iNAAC;gDAAI,WAAU;0DACX,cAAA,iNAAC;oDAAI,KAAK;oDAAmB,WAAU;;;;;;;;;;;;;;;;;kDAK/C,iNAAC;wCAAI,WAAW,CAAC,+DAA+D,EAAE,SAAS,8BAA8B,2BAA2B;;0DAEhJ,iNAAC;gDAAI,WAAU;;kEAEX,iNAAC;wDAAI,WAAU;kEACV;4DACG;gEAAE,IAAI;gEAAa,OAAO;4DAAiB;4DAC3C;gEAAE,IAAI;gEAAU,OAAO;4DAAgB;4DACvC;gEAAE,IAAI;gEAAU,OAAO;4DAAgB;yDAC1C,CAAC,GAAG,CAAC,CAAC,kBACH,iNAAC;gEAEG,SAAS;oEACL,aAAa,EAAE,EAAE;oEACjB,sBAAsB;oEACtB,IAAI,EAAE,EAAE,KAAK,UAAU;wEAAE,gBAAgB;wEAAO,oBAAoB;wEAAO,mBAAmB,EAAE;wEAAG,sBAAsB;wEAAI,oBAAoB;oEAAI;oEACrJ,IAAI,EAAE,EAAE,KAAK,aAAa;wEAAE,kBAAkB;wEAAK,mBAAmB;wEAAO,uBAAuB;wEAAO,sBAAsB,EAAE;wEAAG,yBAAyB;wEAAI,uBAAuB;oEAAI;gEAClM;gEACA,WAAW,CAAC,wEAAwE,EAAE,cAAc,EAAE,EAAE,GACjG,SAAS,kCAAkC,kCAC5C,8DAA8D;0EAEnE,EAAE,KAAK;+DAXH,EAAE,EAAE;;;;;;;;;;oDAgBpB,cAAc,0BACX,iNAAC;wDAAI,WAAW,CAAC,iEAAiE,EAAE,SAAS,mCAAmC,oCAAoC;;0EAChK,iNAAC;gEAAI,WAAU;gEAA8C,MAAK;gEAAO,QAAO;gEAAe,SAAQ;0EAAY,cAAA,iNAAC;oEAAK,eAAc;oEAAQ,gBAAe;oEAAQ,aAAa;oEAAG,GAAE;;;;;;;;;;;0EACxL,iNAAC;gEACG,WAAU;gEACV,OAAO;gEACP,UAAU,CAAC,IAAM,UAAU,EAAE,MAAM,CAAC,KAAK;gEACzC,aAAY;;;;;;;;;;;;;;;;;;0DAM5B,iNAAC;gDAAI,WAAU;0DACX,cAAA,iNAAC;oDAAI,WAAU;8DACX,cAAA,iNAAC;wDAAM,WAAU;;0EACb,iNAAC;gEAAM,WAAW,CAAC,mDAAmD,EAAE,SAAS,kCAAkC,kCAAkC;0EACjJ,cAAA,iNAAC;;wEACI,cAAc,eAAe;4EAAC;4EAAU;4EAAQ;4EAAS;4EAAQ;4EAAgB;yEAAiB,CAAC,GAAG,CAAC,CAAA,kBAAK,iNAAC;gFAAW,WAAU;0FAA2C;+EAAxD;;;;;wEACrH,cAAc,YAAY;4EAAC;4EAAM;4EAAU;4EAAQ;4EAAQ;4EAAO;yEAAS,CAAC,GAAG,CAAC,CAAA,kBAAK,iNAAC;gFAAW,WAAU;0FAA2C;+EAAxD;;;;;wEAC9F,cAAc,YAAY;4EAAC;4EAAO;4EAAU;4EAAS;yEAAO,CAAC,GAAG,CAAC,CAAA,kBAAK,iNAAC;gFAAW,WAAU;0FAA2C;+EAAxD;;;;;;;;;;;;;;;;0EAGxF,iNAAC;gEAAM,WAAU;;oEAEZ,cAAc,eAAe,CAC1B,iCAAmB,iNAAC;kFAAG,cAAA,iNAAC;4EAAG,SAAS;4EAAG,WAAU;sFAAyC;;;;;;;;;;+EACtF,+BAAiB,iNAAC;kFAAG,cAAA,iNAAC;4EAAG,SAAS;4EAAG,WAAU;sFAAuC;;;;;;;;;;+EAClF,cAAc,MAAM,KAAK,kBAAI,iNAAC;kFAAG,cAAA,iNAAC;4EAAG,SAAS;4EAAG,WAAU;sFAAyC;;;;;;;;;;+EAChG,cAAc,GAAG,CAAC,CAAA;wEACd,MAAM,MAAM,OAAO,EAAE,MAAM,IAAI,IAAI,WAAW;wEAC9C,MAAM,WAAW,OAAO,EAAE,WAAW,IAAI;wEACzC,MAAM,OAAO,OAAO,WAAW,CAAC,IAAI,EAAE,SAAS;wEAC/C,MAAM,QAAQ,OAAO,EAAE,QAAQ,IAAI;wEACnC,MAAM,SAAS,OAAO,EAAE,QAAQ,IAAI;wEACpC,MAAM,aAAa,AAAC,OAAO,QAAQ,CAAC,SAAS,OAAO,QAAQ,CAAC,SAAU,CAAC,OAAO,KAAK,IAAI,SAAS;wEAEjG,qBACI,iNAAC;4EAAsC,WAAU;;8FAC7C,iNAAC;oFAAG,WAAU;oFAA8D,SAAS,IAAM,kBAAkB;8FAAO;;;;;;8FACpH,iNAAC;oFAAG,WAAU;8FAAwC,UAAU,OAAO,OAAO,CAAC;;;;;;8FAC/E,iNAAC;oFAAG,WAAU;8FAAuB,UAAU,MAAM,OAAO,CAAC;;;;;;8FAC7D,iNAAC;oFAAG,WAAU;8FAAuB,YAAY;;;;;;8FACjD,iNAAC;oFAAG,WAAW,CAAC,oBAAoB,EAAE,YAAY,IAAI,qBAAqB,iBAAiB;;wFAAG,WAAW,KAAK;wFAAK,UAAU,SAAS,OAAO,CAAC;;;;;;;8FAC/I,iNAAC;oFAAG,WAAW,CAAC,oBAAoB,EAAE,cAAc,IAAI,qBAAqB,iBAAiB;;wFAAG,aAAa,KAAK;wFAAK,UAAU,WAAW,OAAO,CAAC;;;;;;;;2EANhJ,EAAE,EAAE,IAAI,GAAG,EAAE,MAAM,CAAC,CAAC,EAAE,KAAK;;;;;oEAS7C,EAChB;oEAGC,cAAc,YAAY,CACvB,8BAAgB,iNAAC;kFAAG,cAAA,iNAAC;4EAAG,SAAS;4EAAG,WAAU;sFAAyC;;;;;;;;;;+EACnF,WAAW,MAAM,KAAK,kBAAI,iNAAC;kFAAG,cAAA,iNAAC;4EAAG,SAAS;4EAAG,WAAU;sFAAyC;;;;;;;;;;+EAC7F,WAAW,GAAG,CAAC,CAAA,kBACX,iNAAC;4EAAmB,WAAU;;8FAC1B,iNAAC;oFAAG,WAAU;;wFACT,OAAO,EAAE,OAAO,EAAE,KAAK,CAAC,GAAG;wFAAG;sGAC/B,iNAAC;4FAAgB,SAAS,EAAE,OAAO;4FAAE,QAAQ;4FAAQ,QAAQ;;;;;;;;;;;;8FAEjE,iNAAC;oFAAG,WAAU;oFAA8D,SAAS,IAAM,kBAAkB,EAAE,MAAM;8FAAI,EAAE,MAAM;;;;;;8FACjI,iNAAC;oFAAG,WAAU;8FACV,cAAA,iNAAC;wFAAK,WAAW,CAAC,wCAAwC,EAAE,EAAE,IAAI,KAAK,QAAQ,uCAAuC,gCAAgC;kGACjJ,EAAE,IAAI;;;;;;;;;;;8FAGf,iNAAC;oFAAG,WAAU;8FAAsC,EAAE,SAAS;;;;;;8FAC/D,iNAAC;oFAAG,WAAU;8FAAuB,EAAE,QAAQ;;;;;;8FAC/C,iNAAC;oFAAG,WAAU;8FACV,cAAA,iNAAC;wFAAK,WAAW,CAAC,yBAAyB,EAAE,CAAC,UAAU,CAAC,EAAE,OAAO,CAAC,EAAE,UAAU,EAAE,MAAM,MAAM,WAAW,4DACpG,CAAC,UAAU,CAAC,EAAE,OAAO,CAAC,EAAE,UAAU,EAAE,MAAM,MAAM,aAAa,2CACzD,wDACF;kGACD,UAAU,CAAC,EAAE,OAAO,CAAC,EAAE,UAAU,EAAE,MAAM;;;;;;;;;;;;2EAlB7C,EAAE,OAAO;;;;iFAuBlC;oEAGC,cAAc,YAAY,CACvB,MAAM,MAAM,KAAK,kBAAI,iNAAC;kFAAG,cAAA,iNAAC;4EAAG,SAAS;4EAAG,WAAU;sFAAyC;;;;;;;;;;+EACxF,MAAM,GAAG,CAAC,CAAC,CAAC,KAAK,EAAE,iBACf,iNAAC;4EAAa,WAAU;;8FACpB,iNAAC;oFAAG,WAAU;8FACV,cAAA,iNAAC;wFAAO,SAAS,IAAM,UAAU;wFAAM,WAAW,CAAC,QAAQ,EAAE,OAAO,GAAG,CAAC,OAAO,mBAAmB,iEAAiE;kGAC9J,OAAO,GAAG,CAAC,OAAO,MAAM;;;;;;;;;;;8FAGjC,iNAAC;oFAAG,WAAU;oFAA8D,SAAS,IAAM,kBAAkB;8FAAO;;;;;;8FACpH,iNAAC;oFAAG,WAAU;8FAAuB,YAAY,EAAE,KAAK;;;;;;8FACxD,iNAAC;oFAAG,WAAU;8FAAmD,EAAE,EAAE,GAAG,IAAI,KAAK,EAAE,EAAE,EAAE,kBAAkB,KAAK;;;;;;;2EARzG;;;;iFAWrB;;;;;;;;;;;;;;;;;;;;;;;4CAOf,CAAC,cAAc,eAAe,cAAc,QAAQ,mBACjD,iNAAC;gDACG,WAAW,CAAC,+CAA+C,EAAE,SAAS,oBAAoB,kBAAkB;;kEAE5G,iNAAC;wDAAI,WAAU;;4DACV,cAAc,cAAc,wBAAwB;4DAAmB;;;;;;;kEAE5E,iNAAC;wDAAI,WAAU;;0EACX,iNAAC;gEACG,WAAW,CAAC,4CAA4C,EAAE,SAAS,yCAAyC,qCAAqC;gEACjJ,SAAS,IAAM,cAAc,cAAc,mBAAmB,mBAAmB,gBAAgB;gEACjG,UAAU,cAAc,cAAc,mBAAmB;0EAEzD,cAAA,iNAAC;oEAAI,WAAU;oEAAU,MAAK;oEAAO,QAAO;oEAAe,SAAQ;8EAAY,cAAA,iNAAC;wEAAK,eAAc;wEAAQ,gBAAe;wEAAQ,aAAa;wEAAG,GAAE;;;;;;;;;;;;;;;;0EAExJ,iNAAC;gEACG,WAAW,CAAC,4CAA4C,EAAE,SAAS,yCAAyC,qCAAqC;gEACjJ,UAAW,cAAc,cAAc,mBAAmB,MAAM,KAAK,IAAI,gBAAgB,MAAM,KAAK;gEACpG,SAAS;oEACL,IAAI,cAAc,aAAa;wEAC3B,sBAAsB,CAAA;4EAClB,MAAM,OAAO;mFAAI;6EAAK;4EACtB,mBAAmB,KAAK,GAAG,MAAM;4EACjC,OAAO;wEACX;oEACJ,OAAO;wEACH,mBAAmB,CAAA;4EACf,MAAM,OAAO;mFAAI;6EAAK;4EACtB,gBAAgB,KAAK,GAAG,MAAM;4EAC9B,OAAO;wEACX;oEACJ;gEACJ;0EAEA,cAAA,iNAAC,gKAAW;oEAAC,WAAU;;;;;;;;;;;0EAE3B,iNAAC;gEAAK,WAAU;;oEAAkD;oEACxD,cAAc,cAAc,uBAAuB;;;;;;;0EAE7D,iNAAC;gEACG,WAAW,CAAC,4CAA4C,EAAE,SAAS,yCAAyC,qCAAqC;gEACjJ,UAAU,cAAc,cAAe,CAAC,uBAAuB,sBAAwB,CAAC,oBAAoB;gEAC5G,SAAS;oEACL,IAAI,cAAc,eAAe,qBAAqB;wEAClD,sBAAsB,CAAA,IAAK;mFAAI;gFAAG;6EAAgB;wEAClD,mBAAmB;oEACvB,OAAO,IAAI,cAAc,YAAY,kBAAkB;wEACnD,mBAAmB,CAAA,IAAK;mFAAI;gFAAG;6EAAa;wEAC5C,gBAAgB;oEACpB;gEACJ;0EAEA,cAAA,iNAAC,iKAAY;oEAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAWvD,MAAM,IAAI,kBACP,iNAAC;gBAAI,WAAU;;kCACX,iNAAC;wBAAI,WAAU;wBAAmE,SAAS,IAAM,CAAC,kBAAkB,SAAS,CAAA,IAAK,CAAC;oCAAE,GAAG,CAAC;oCAAE,MAAM;gCAAM,CAAC;;;;;;kCACxJ,iNAAC;wBAAI,WAAW,CAAC,gGAAgG,EAAE,SAAS,8BAA8B,2BAA2B;;0CACjL,iNAAC;gCAAI,WAAW,CAAC,aAAa,EAAE,MAAM,MAAM,KAAK,WAAW,mBAAmB,MAAM,MAAM,KAAK,aAAa,gBAAgB,kBAAkB;;;;;;0CAC/I,iNAAC;gCAAI,WAAU;;kDACX,iNAAC;wCAAG,WAAU;kDAAyC,MAAM,KAAK;;;;;;kDAClE,iNAAC;wCAAE,WAAW,CAAC,aAAa,EAAE,SAAS,qBAAqB,oBAAoB;kDAAG,MAAM,OAAO;;;;;;kDAEhG,iNAAC;wCAAI,WAAU;;0DACX,iNAAC;gDACG,SAAS;oDAAQ,aAAa;oDAAW,SAAS,CAAA,IAAK,CAAC;4DAAE,GAAG,CAAC;4DAAE,MAAM;wDAAM,CAAC;gDAAI;gDACjF,WAAW,CAAC,oDAAoD,EAAE,SAAS,qCAAqC,0CAA0C;0DAC7J;;;;;;0DAGD,iNAAC;gDACG,SAAS,IAAM,SAAS,CAAA,IAAK,CAAC;4DAAE,GAAG,CAAC;4DAAE,MAAM;wDAAM,CAAC;gDACnD,WAAW,CAAC,2CAA2C,EAAE,SAAS,6CAA6C,4CAA4C;0DAC9J;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUjC;GAxpDwB;;QACL,sKAAS;;;KADJ;;;AA8pDxB,MAAM,kBAAkB,CAAC,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE;;IAChD,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,6LAAQ,EAAC;IAErC,MAAM,cAAc;QAChB,oCAAoC;QACpC,IAAI,QAAQ;YACR,OAAO;QACX,OAAO;YACH,iCAAiC;YACjC,UAAU,SAAS,CAAC,SAAS,CAAC;QAClC;QAEA,6BAA6B;QAC7B,UAAU;QAEV,iCAAiC;QACjC,WAAW;YACP,UAAU;QACd,GAAG;IACP;IAEA,qBACI,iNAAC;QACG,MAAK;QACL,SAAS;QACT,WAAW,CAAC,wCAAwC,EAAE,SAChD,uBACA,qBACD,CAAC,EAAE,SACE,6BAA6B,wCAAwC;WACrE,SAAS,mBAAmB,kBAChC;QACN,OAAO,SAAS,YAAY;kBAE3B,uBAAS,iNAAC,4JAAO;YAAC,WAAU;;;;;qEAAe,iNAAC,2JAAM;YAAC,WAAU;;;;;;;;;;;AAG1E;IArCM;MAAA"}}]
}